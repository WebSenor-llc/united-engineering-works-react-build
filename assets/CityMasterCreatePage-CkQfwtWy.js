import{u as w,i as T,r as l,j as e,B as f,A as g,h as o,e as n,y as d}from"./index-t0IFwL8M.js";import{T as A}from"./TextInput-QmslspjS.js";import{T as F}from"./TextArea-CP0uZkks.js";import{F as I}from"./FormHeader-CWbgWAxs.js";import{L as E}from"./Loading-lq3qLz_z.js";import{o as M,d as P}from"./yup-B1elfFPl.js";import{u as L,C as c}from"./index.esm-BHkj_6Re.js";import"./BackButton-DPTpGdDT.js";const k={name:"",state_id:void 0,is_active:!0,note:""},G=()=>{const m=w(),[h]=T(),a=h.get("id"),[y,u]=l.useState(!1),[x,p]=l.useState(!1),[j,v]=l.useState([]),{control:r,handleSubmit:b,reset:C,formState:{errors:i}}=L({defaultValues:k,resolver:M(P)}),N=async()=>{try{const t=await o.get(n.state_master.all),s=t.data.data||t.data||[];v(s)}catch(t){console.error("Failed to fetch states",t)}},S=async()=>{if(a){u(!0);try{const t=await o.get(n.city_master.details(Number(a))),s=t.data.data||t.data||{};C({name:s.name||"",state_id:s.state_id,is_active:s.is_active??!0,note:s.note||""})}catch(t){console.error("Failed to load city details:",t),d.error("Failed to load city details")}finally{u(!1)}}};l.useEffect(()=>{N(),a&&S()},[a]);const _=async t=>{p(!0);try{const s=a?n.city_master.update(Number(a)):n.city_master.create;await(a?o.put:o.post)(s,t),d.success(a?"City Updated Successfully":"City Created Successfully"),m(g.CITY_MASTER.LIST)}catch(s){console.error(s),d.error(s.response?.data?.message||"Failed to save city")}finally{p(!1)}};return y?e.jsx("div",{className:"flex justify-center py-20",children:e.jsx(E,{})}):e.jsxs("div",{className:"w-full h-full overflow-auto space-y-8 p-4 pb-20",children:[e.jsx("div",{className:"space-y-1 ml-2",children:e.jsx(I,{title:a?"Edit City Master":"Create City Master",subtitle:a?"Update the city master details":"Fill out the form to create a new city master"})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mx-2",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(c,{name:"name",control:r,render:({field:t})=>e.jsx(A,{required:!0,...t,label:"City Name",error:i?.name?.message})}),e.jsx(c,{name:"state_id",control:r,render:({field:t})=>e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("label",{className:"text-sm font-semibold text-gray-700 mb-1",children:["State ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{...t,className:"w-full rounded-lg border border-gray-300 mt-1 px-3 py-3 text-gray-700 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white",children:[e.jsx("option",{value:"",children:"Select State"}),j.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),i?.state_id?.message&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:i.state_id.message})]})}),e.jsx(c,{name:"is_active",control:r,render:({field:t})=>e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["Is Active ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{...t,value:t.value?"true":"false",onChange:s=>t.onChange(s.target.value==="true"),className:"w-full border border-gray-300 rounded-lg px-3 py-3 bg-white text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"true",children:"Active"}),e.jsx("option",{value:"false",children:"Inactive"})]})]})})]}),e.jsx("div",{className:"mt-6",children:e.jsx(c,{name:"note",control:r,render:({field:t})=>e.jsx(F,{...t,label:"Note",placeholder:"Add any additional notes or comments...",error:i?.note?.message,rows:3})})}),e.jsxs("div",{className:"flex justify-end gap-3 mt-8",children:[e.jsx(f,{onClick:()=>m(g.CITY_MASTER.LIST),variant:"outline",children:"Cancel"}),e.jsx(f,{onClick:b(_),loading:x,disabled:x,className:"bg-red-600 text-white",children:a?"Update City":"Create City"})]})]})]})};export{G as default};
