import{u as k,i as C,a as S,r as u,j as e,B as j,h as l,e as m,y as p}from"./index-BEme_EUt.js";import{u as w,C as n}from"./index.esm-Byko3XjL.js";import{o as U,i as F,a as A}from"./yup-Bf02Bbdb.js";import{T as d}from"./TextInput-DHAOM3Cm.js";import{T as M}from"./TextArea-CrIxoYkp.js";import{L as T}from"./Loading-Dz3FfgiZ.js";import{F as q}from"./FormHeader-pxQK6ddz.js";import"./BackButton-BXqri_9e.js";const E={item_name:"",description:"",unit_id:"",is_active:!0,current_stock:"",note:""},G=()=>{const _=k(),[x]=C(),r=x.get("editId")?Number(x.get("editId")):void 0,{selectedBranchId:f}=S(),[c,o]=u.useState(!1),[h,v]=u.useState([]),{control:i,handleSubmit:g,reset:b,formState:{errors:a}}=w({defaultValues:E,resolver:U(r?A:F)}),y=async()=>{o(!0);try{const t=await l.get(m.unit_master.units);v(t.data.units)}finally{o(!1)}},I=async()=>{if(r){o(!0);try{const s=(await l.get(m.item_master.details(r))).data.item;b({item_name:s.item_name,item_code:s.item_code,description:s.description,is_active:s.is_active,current_stock:s.current_stock,unit_id:s.unit_id,note:s.note||"",branch_id:f})}finally{o(!1)}}};u.useEffect(()=>{y(),r&&I()},[r]);const N=async t=>{o(!0);try{const s=r?{item_name:t.item_name,description:t.description,is_active:t.is_active,unit_id:t.unit_id,current_stock:t.current_stock}:{item_name:t.item_name,description:t.description,is_active:t.is_active,unit_id:t.unit_id,current_stock:t.current_stock};r?(await l.put(m.item_master.update(r),s),p.success("Item Updated Successfully")):(await l.post(m.item_master.create,s),p.success("Item Created Successfully")),_("/master/item-master/list")}catch(s){console.error(s),p.error(s.response?.data?.message||"Failed to save item")}finally{o(!1)}};return c&&r?e.jsx("div",{className:"flex justify-center py-20",children:e.jsx(T,{})}):e.jsxs("div",{className:"w-full h-full overflow-auto space-y-8 p-4 pb-20",children:[e.jsx("div",{className:"space-y-1 ml-2",children:e.jsx(q,{title:r?"Edit Item Master":"Create Item Master",subtitle:r?"Update the Item Master details":"Fill out the form to submit a new Item Master."})}),e.jsxs("div",{className:"grid grid-cols-3 gap-5 ml-2 mr-5 mt-5",children:[e.jsx(n,{name:"item_name",control:i,render:({field:t})=>e.jsx(d,{required:!0,...t,label:"Item Name",error:a?.item_name?.message})}),r&&e.jsx(n,{name:"item_code",control:i,render:({field:t})=>e.jsx(d,{required:!0,...t,label:"Item Code",error:a?.item_code?.message,disabled:!!r})}),e.jsx(n,{name:"description",control:i,render:({field:t})=>e.jsx(d,{required:!0,...t,label:"Description",error:a?.description?.message})}),e.jsx(n,{name:"unit_id",control:i,render:({field:t})=>e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1",children:"Unit"}),e.jsxs("select",{...t,className:"w-full p-2 border rounded disabled:bg-gray-100",children:[e.jsx("option",{value:"",children:"Select Unit"}),h.filter(s=>s.is_active).map(s=>e.jsx("option",{value:s.id,children:s.unit_name},s.id))]}),a?.unit_id?.message&&e.jsx("p",{className:"text-red-500 text-xs",children:a.unit_id.message})]})}),e.jsx(n,{name:"current_stock",control:i,render:({field:t})=>e.jsx(d,{required:!0,...t,type:"number",label:"Current Stock",error:a?.current_stock?.message})}),e.jsx(n,{name:"is_active",control:i,render:({field:t})=>e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1",children:"Is Active"}),e.jsxs("select",{...t,onChange:s=>t.onChange(s.target.value==="true"),className:"w-full border rounded p-2",value:t.value?"true":"false",children:[e.jsx("option",{value:"true",children:"True"}),e.jsx("option",{value:"false",children:"False"})]})]})})]}),e.jsx("div",{className:"ml-2 mr-5 mt-5",children:e.jsx(n,{name:"note",control:i,render:({field:t})=>e.jsx(M,{...t,label:"Note",placeholder:"Add any additional notes or comments...",rows:3,error:a?.note?.message})})}),e.jsxs("div",{className:"flex justify-end gap-3 mt-5 mr-5",children:[e.jsx(j,{onClick:()=>_("/master/item-master/list"),variant:"outline",disabled:c,children:"Cancel"}),e.jsx(j,{onClick:g(N),loading:c,disabled:c,children:r?"Update Item":"Create Item"})]})]})};export{G as default};
