import{u as F,a as L,r,j as t,A as N,h as g,e as h,y as i}from"./index-Dtfd8qjT.js";import{L as D}from"./ListWrapper-hoGOUdW1.js";import{T as R,a as S,b as s}from"./TableWrapper-fkimiI7e.js";import{T as v}from"./TableRow-DKSDSB8G.js";import{u as w}from"./usePagination-ClAJZ8c0.js";import{T as C}from"./TableActions-BgZBRsUb.js";import{T as G}from"./TableDelete-z9MmpzJZ.js";import{L as V}from"./Loading-F6CT88o7.js";import{C as k}from"./CommonFilter-BO2Z5KtL.js";import"./index.esm-BEFVFIom.js";import"./TextInput-CKSwcBfK.js";const Q=()=>{const{page:o,rowsPerPage:n,setTotal:f,renderPagination:x}=w(),j=F(),{selectedBranchId:d}=L(),[c,b]=r.useState([]),[y,m]=r.useState(!1),[p,T]=r.useState({}),P=[{name:"date_from",label:"Date From",type:"date"},{name:"date_to",label:"Date To",type:"date"}],l=async e=>{m(!0);try{const a={page:o+1,rowsPerPage:n,branch_id:d};e&&(e.date_from&&e.date_to?e.date_from===e.date_to?a.date=e.date_from:(a.date_from=e.date_from,a.date_to=e.date_to):(e.date_from&&(a.date_from=e.date_from),e.date_to&&(a.date_to=e.date_to)));const u=await g.get(h.returnable_gate_pass.items,{params:a}),_=u.data?.pagination;b(u.data.gate_passes||[]),_?.total!==void 0&&f(_.total)}catch(a){console.error("Error fetching gate passes:",a),i.error("Failed to load returnable gate passes")}finally{m(!1)}};r.useEffect(()=>{l(p)},[o,n,d]);const A=async e=>{T(e),await l(e)},E=async e=>{try{await g.delete(h.returnable_gate_pass.delete(e)),i.success("Returnable gate pass deleted successfully"),l()}catch(a){console.error("Failed to delete gate pass",a),i.error(a?.response?.data?.message||"Failed to delete returnable gate pass")}};return t.jsxs("div",{className:"space-y-6",children:[t.jsx(k,{fields:P,onFilter:A,defaultValues:p}),t.jsxs(D,{title:"Returnable GatePass List",createOnClick:()=>j(N.RETURNABLE_GATEPAS.CREATE),children:[y?t.jsx("div",{className:"flex justify-center py-10",children:t.jsx(V,{})}):t.jsxs(R,{children:[t.jsx(S,{cols:[{title:"Date"},{title:"Party Name"},{title:"Purpose"},{title:"Vehicle Number"},{title:"Action"}]}),t.jsx("tbody",{children:c.length===0?t.jsx("tr",{children:t.jsx("td",{colSpan:6,className:"text-center py-8 text-gray-500",children:"No returnable gate passes found"})}):c.map((e,a)=>t.jsxs(v,{children:[t.jsx(s,{className:"px-5",children:o*n+a+1}),t.jsx(s,{children:new Date(e.gate_pass_date||e.created_at||"").toLocaleDateString()}),t.jsx(s,{children:e.party_name}),t.jsx(s,{children:e.purpose}),t.jsx(s,{children:e.vehicle_number}),t.jsx(s,{children:t.jsx(C,{children:t.jsx(G,{onClick:()=>E(e.id)})})})]},e.id))})]}),x()]})]})};export{Q as default};
