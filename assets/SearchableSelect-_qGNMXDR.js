import{r,j as o,O as B,i as j}from"./index-B2jzE3KR.js";const K=r.forwardRef(({options:R,value:L,onChange:N,placeholder:k="Select",disabled:m,error:x,className:C,onSearch:v,loading:g=!1,minSearchLength:y=2},I)=>{const[s,n]=r.useState(!1),[c,u]=r.useState(""),[i,E]=r.useState(""),[h,l]=r.useState(-1),[b,O]=r.useState({top:0,left:0,width:0}),d=r.useRef(null),D=r.useRef(null),z=r.useRef(null),f=R??[],A=f.find(e=>e.value===L);r.useImperativeHandle(I,()=>({close:()=>{n(!1),u(""),l(-1)}})),r.useEffect(()=>{if(c.length<y){E("");return}const e=setTimeout(()=>{E(c),v?.(c)},300);return()=>clearTimeout(e)},[c,v,y]);const p=r.useMemo(()=>i?f.filter(e=>e.label.toLowerCase().includes(i.toLowerCase())):f,[i,f]),a=()=>{if(!d.current)return;const e=d.current.getBoundingClientRect();O({top:e.bottom+window.scrollY,left:e.left+window.scrollX,width:e.width})};r.useEffect(()=>{if(s)return a(),window.addEventListener("resize",a),window.addEventListener("scroll",a,!0),()=>{window.removeEventListener("resize",a),window.removeEventListener("scroll",a,!0)}},[s]),r.useEffect(()=>{const e=t=>{const w=t.target,M=d.current?.contains(w),T=D.current?.contains(w);!M&&!T&&(n(!1),u(""),l(-1))};return s&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[s]);const S=e=>{N(e.value),n(!1),u(""),l(-1)},H=()=>s?c:A?.label??"";return o.jsxs("div",{className:"relative w-full",ref:d,children:[o.jsx("input",{ref:z,type:"text",disabled:m,value:H(),placeholder:k,onFocus:()=>n(!0),onChange:e=>{u(e.target.value),n(!0),l(-1)},onKeyDown:e=>{if(s){if(e.key==="ArrowDown"&&(e.preventDefault(),l(t=>t<p.length-1?t+1:t)),e.key==="ArrowUp"&&(e.preventDefault(),l(t=>t>0?t-1:t)),e.key==="Enter"){e.preventDefault();const t=p[h];t&&S(t)}e.key==="Escape"&&n(!1)}},className:j("w-full rounded-lg border px-4 py-3 text-sm bg-gray-50 focus:outline-none",x?"border-red-500 focus:ring-2 focus:ring-red-200":"border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-500",m&&"cursor-not-allowed opacity-80",C)}),s&&!m&&B.createPortal(o.jsxs("div",{ref:D,role:"listbox",className:"absolute z-50 rounded-lg border border-gray-300 bg-white shadow-lg max-h-60 overflow-auto",style:{top:b.top+4,left:b.left,width:b.width},children:[g&&o.jsx("div",{className:"px-4 py-2 text-sm text-gray-500",children:"Loading..."}),!g&&i&&p.length===0&&o.jsx("div",{className:"px-4 py-2 text-sm text-gray-500",children:"No results found"}),!g&&p.map((e,t)=>o.jsx("div",{role:"option","aria-selected":t===h,className:j("px-4 py-2 text-sm cursor-pointer border-b last:border-b-0",t===h?"bg-blue-100":"hover:bg-blue-50"),onMouseDown:w=>w.preventDefault(),onClick:()=>S(e),children:e.label},e.value))]}),document.body),x&&o.jsx("p",{className:"text-xs text-red-500 mt-1 font-medium",children:x})]})});export{K as S};
