import{j as e,u as E,r as y,a as I,A as C,h as T,e as w,y as p}from"./index-C-HhpDkY.js";import{L}from"./ListWrapper-DOgiLfWA.js";import{T as G,a as z,b as h}from"./TableWrapper-ClISlYEF.js";import{T as P}from"./TableRow-CfaCzneu.js";import{u as F}from"./usePagination-84yGnTMg.js";import{T as V}from"./TableActions-DN0qvBjN.js";import{T as W}from"./TableDelete-BioVSJwJ.js";import{T as k}from"./TableView-CQ-OPtVm.js";import{T as H}from"./TableDownload-BXTTOFoD.js";import{L as U}from"./Loading-C6uwP82P.js";import{C as O}from"./CommonFilter-Bd-y7X-d.js";import{Document as $,Page as q,StyleSheet as K,View as s,Image as Q,Text as l,PDFDownloadLink as J}from"./react-pdf.browser-DemeXHlN.js";import"./index.esm-BpE9IZoC.js";import"./TextInput-DE9vic5T.js";const Y=i=>i?new Date(i).toLocaleDateString("en-IN",{day:"2-digit",month:"2-digit",year:"numeric"}):"-",Z=({gatePass:i})=>{const d=i.items||[];return e.jsx($,{children:e.jsxs(q,{size:"A4",style:t.page,children:[e.jsxs(s,{style:t.headerContainer,children:[e.jsx(s,{style:t.logoSection,children:e.jsx(Q,{src:"/assets/images/logo.png",style:t.logo})}),e.jsxs(s,{style:t.companyInfo,children:[e.jsx(l,{style:t.companyName,children:"UNITED ENGINEERING WORKS"}),e.jsx(l,{style:t.companyAddress,children:"N.H. 8, Nehla Village, By Pass Road, Near Govardhan Vilas, Udaipur- 313001 (Raj.) INDIA"}),e.jsx(l,{style:t.companyContact,children:"Phone: +91-9829232445 +91-9829657145 | GSTIN: 08ABQPK8948J3ZP"}),e.jsx(l,{style:t.companyContact,children:"Email: info@unitedengineeringworks.com"})]})]}),e.jsx(l,{style:t.title,children:"NON-RETURNABLE GATE PASS"}),e.jsxs(s,{style:t.infoContainer,children:[e.jsxs(s,{style:t.gatePassDetailsBox,children:[e.jsxs(s,{style:t.detailRow,children:[e.jsx(l,{style:t.label,children:"Gate Pass No:"}),e.jsx(l,{style:t.value,children:i.gate_pass_number})]}),e.jsxs(s,{style:t.detailRow,children:[e.jsx(l,{style:t.label,children:"Date:"}),e.jsx(l,{style:t.value,children:Y(i.created_at)})]}),e.jsxs(s,{style:t.detailRow,children:[e.jsx(l,{style:t.label,children:"Branch:"}),e.jsx(l,{style:t.value,children:i.branch?.branch_name||"-"})]}),e.jsxs(s,{style:t.detailRow,children:[e.jsx(l,{style:t.label,children:"Branch Address:"}),e.jsx(l,{style:t.value,children:i.branch?.address||"-"})]}),e.jsxs(s,{style:t.detailRow,children:[e.jsx(l,{style:t.label,children:"Purpose:"}),e.jsx(l,{style:t.value,children:i.purpose||"-"})]})]}),e.jsxs(s,{style:t.partyDetailsBox,children:[e.jsx(l,{style:t.partyTitle,children:"PARTY & VEHICLE DETAILS"}),e.jsxs(s,{style:t.detailRow,children:[e.jsx(l,{style:t.label,children:"Party Name:"}),e.jsx(l,{style:t.value,children:i.party_name||"-"})]}),e.jsxs(s,{style:t.detailRow,children:[e.jsx(l,{style:t.label,children:"Party Address:"}),e.jsx(l,{style:t.value,children:i.party_address||"-"})]}),e.jsxs(s,{style:t.detailRow,children:[e.jsx(l,{style:t.label,children:"Employee Name:"}),e.jsx(l,{style:t.value,children:i.emp_name||"-"})]}),e.jsxs(s,{style:t.detailRow,children:[e.jsx(l,{style:t.label,children:"Employee Address:"}),e.jsx(l,{style:t.value,children:i.emp_address||"-"})]}),e.jsxs(s,{style:t.detailRow,children:[e.jsx(l,{style:t.label,children:"Vehicle No:"}),e.jsx(l,{style:t.value,children:i.vehicle_number||"-"})]}),e.jsxs(s,{style:t.detailRow,children:[e.jsx(l,{style:t.label,children:"Driver Name:"}),e.jsx(l,{style:t.value,children:i.driver_name||"-"})]})]})]}),e.jsxs(s,{style:t.tableContainer,children:[e.jsxs(s,{style:t.tableHeaderRow,children:[e.jsx(s,{style:[t.tableCell,t.snoCol,t.headerCell],children:e.jsx(l,{style:t.headerText,children:"Sr No"})}),e.jsx(s,{style:[t.tableCell,t.descriptionCol,t.headerCell],children:e.jsx(l,{style:t.headerText,children:"Description of Items"})}),e.jsx(s,{style:[t.tableCell,t.codeCol,t.headerCell],children:e.jsx(l,{style:t.headerText,children:"Code"})}),e.jsx(s,{style:[t.tableCell,t.unitCol,t.headerCell],children:e.jsx(l,{style:t.headerText,children:"Unit"})}),e.jsx(s,{style:[t.tableCell,t.qtyCol,t.headerCell],children:e.jsx(l,{style:t.headerText,children:"Qty"})}),e.jsx(s,{style:[t.tableCell,t.remarkCol,t.headerCell],children:e.jsx(l,{style:t.headerText,children:"Remark"})})]}),d.length>0?d.map((o,x)=>e.jsxs(s,{style:t.tableRow,children:[e.jsx(s,{style:[t.tableCell,t.snoCol],children:e.jsx(l,{style:t.cellText,children:x+1})}),e.jsx(s,{style:[t.tableCell,t.descriptionCol],children:e.jsx(l,{style:t.cellText,children:o.item?.item_name||"-"})}),e.jsx(s,{style:[t.tableCell,t.codeCol],children:e.jsx(l,{style:t.cellText,children:o.item?.item_code||"-"})}),e.jsx(s,{style:[t.tableCell,t.unitCol],children:e.jsx(l,{style:t.cellText,children:o.item?.unit?.unit_name||"-"})}),e.jsx(s,{style:[t.tableCell,t.qtyCol],children:e.jsx(l,{style:t.cellText,children:o.quantity_out||0})}),e.jsx(s,{style:[t.tableCell,t.remarkCol],children:e.jsx(l,{style:t.cellText,children:o.item_description||"-"})})]},o.id||x)):e.jsx(s,{style:t.tableRow,children:e.jsx(s,{style:[t.tableCell,{width:"100%"}],children:e.jsx(l,{style:t.cellText,children:"No items found"})})})]}),e.jsx(s,{style:t.vehicleSection,children:e.jsxs(s,{style:t.vehicleRow,children:[e.jsx(l,{style:t.vehicleLabel,children:"Vehicle No: "}),e.jsx(l,{style:t.vehicleValue,children:i.vehicle_number||"____________________"}),e.jsx(l,{style:t.vehicleLabel,children:"Driver: "}),e.jsx(l,{style:t.vehicleValue,children:i.driver_name||"____________________"})]})}),e.jsxs(s,{style:t.signatureContainer,children:[e.jsxs(s,{style:t.signatureBox,children:[e.jsx(l,{style:t.signatureTitle,children:"Prepared by"}),e.jsx(l,{style:t.signatureText,children:i.preparer?.full_name||""}),e.jsx(s,{style:t.signatureLine})]}),e.jsxs(s,{style:t.signatureBox,children:[e.jsx(l,{style:t.signatureTitle,children:"Checked by"}),e.jsx(s,{style:t.signatureLine})]}),e.jsxs(s,{style:t.signatureBox,children:[e.jsx(l,{style:t.signatureTitle,children:"Authorized Signature"}),e.jsx(s,{style:t.signatureLine})]})]}),e.jsx(s,{style:t.footer,children:e.jsx(l,{style:t.footerText,children:"For: UNITED ENGINEERING WORKS, UDAIPUR"})})]})})},t=K.create({page:{padding:20,fontSize:10,fontFamily:"Helvetica",lineHeight:1.3},headerContainer:{flexDirection:"row",alignItems:"center",marginBottom:15,paddingBottom:10,borderBottomWidth:2,borderBottomColor:"#000",gap:10},logoSection:{width:70,marginRight:20},logo:{width:60,height:50},companyInfo:{flex:1,alignItems:"flex-start"},companyName:{fontSize:16,fontWeight:"bold",marginBottom:4},companyAddress:{fontSize:10,marginBottom:2},companyContact:{fontSize:10},title:{fontSize:18,textAlign:"center",marginBottom:15,fontWeight:"bold",textDecoration:"underline"},infoContainer:{flexDirection:"row",marginBottom:15,justifyContent:"space-between"},gatePassDetailsBox:{width:"48%",padding:8,marginTop:10},partyDetailsBox:{width:"48%",padding:8,marginTop:10},partyTitle:{fontSize:11,fontWeight:"bold",marginBottom:5,textAlign:"center"},detailRow:{flexDirection:"row",marginBottom:3},label:{width:"35%",fontSize:9,fontWeight:"bold",marginLeft:0},value:{width:"65%",fontSize:9},tableContainer:{marginBottom:15,borderWidth:1,borderColor:"#000"},tableHeaderRow:{flexDirection:"row",backgroundColor:"#e0e0e0"},tableRow:{flexDirection:"row",minHeight:25},tableCell:{padding:4,borderWidth:.5,borderColor:"#000",justifyContent:"center",alignItems:"center"},headerCell:{backgroundColor:"#f0f0f0"},headerText:{fontSize:9,fontWeight:"bold",textAlign:"center"},cellText:{fontSize:8,textAlign:"center"},snoCol:{width:"8%"},descriptionCol:{width:"35%"},codeCol:{width:"15%"},unitCol:{width:"10%"},qtyCol:{width:"10%"},remarkCol:{width:"22%"},vehicleSection:{marginBottom:20,paddingHorizontal:10},vehicleRow:{flexDirection:"row",alignItems:"center",justifyContent:"flex-start",gap:10},vehicleLabel:{fontSize:10,fontWeight:"bold"},vehicleValue:{fontSize:10,marginRight:30},signatureContainer:{flexDirection:"row",justifyContent:"space-between",marginTop:40,marginBottom:20,paddingHorizontal:20},signatureBox:{width:"30%",alignItems:"center"},signatureTitle:{fontSize:10,fontWeight:"bold",marginBottom:10},signatureLine:{width:120,height:1,backgroundColor:"#000",marginBottom:2},signatureText:{fontSize:9,textAlign:"center"},footer:{alignItems:"center",marginTop:20},footerText:{fontSize:10,fontWeight:"bold"}}),xe=()=>{const{page:i,rowsPerPage:d,setTotal:o,renderPagination:x}=F(),N=E(),[u,f]=y.useState([]),[R,g]=y.useState(!1),{selectedBranchId:_}=I(),[m,D]=y.useState({}),v=[{name:"date_from",label:"Date From",type:"date"},{name:"date_to",label:"Date To",type:"date"}],S=n=>{if(!n)return"";const[r]=n.split("T"),[a,c,j]=r.split("-");return`${j}-${c}-${a}`};y.useEffect(()=>{(async r=>{g(!0);try{const a={page:i+1,rowsPerPage:d,branch_id:_};r&&(r.date_from&&r.date_to?r.date_from===r.date_to?a.date=r.date_from:(a.date_from=r.date_from,a.date_to=r.date_to):(r.date_from&&(a.date_from=r.date_from),r.date_to&&(a.date_to=r.date_to)));const c=await T.get(w.non_returnable_gate_pass.items,{params:a}),j=c.data?.gate_passes||c.data?.data||c.data||[],b=c.data?.pagination;f(j),b?.total!==void 0&&o(b.total)}catch(a){console.error("Failed to fetch non-returnable gate passes",a),p.error("Failed to load gate passes")}finally{g(!1)}})(m)},[i,d,_,m]);const A=async n=>{D(n)},B=async n=>{try{await T.delete(w.non_returnable_gate_pass.delete(n)),f(r=>r.filter(a=>a.id!==n)),p.success("Gate pass deleted successfully")}catch(r){console.error("Failed to delete gate pass",r),p.error("Failed to delete gate pass")}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(O,{fields:v,onFilter:A,defaultValues:m}),e.jsxs(L,{title:"Non Returnable Gate Pass List",createOnClick:()=>N(C.NON_RETURNABLE_GATEPAS.CREATE),children:[R?e.jsx("div",{className:"flex justify-center py-10",children:e.jsx(U,{})}):e.jsxs(G,{children:[e.jsx(z,{cols:[{title:"Date"},{title:"Party Name"},{title:"Purpose"},{title:"Vehicle Number"},{title:"Actions"}]}),e.jsx("tbody",{children:u.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center py-8 text-gray-500",children:"No gate passes found"})}):u.map((n,r)=>e.jsxs(P,{children:[e.jsx(h,{className:"px-5",children:i*d+r+1}),e.jsx(h,{children:S(n.created_at||n.date)}),e.jsx(h,{children:n.party_name||"-"}),e.jsx(h,{children:n.purpose||"-"}),e.jsx(h,{children:n.vehicle_number||"-"}),e.jsx(h,{children:e.jsxs(V,{children:[e.jsx(k,{url:`${C.NON_RETURNABLE_GATEPAS.DETAILS.replace(":id","")}${n.id}`,tooltip:"View Non-Returnable Gate Pass Details"}),e.jsx(J,{document:e.jsx(Z,{gatePass:n}),fileName:`Non-Returnable-Gate-Pass-${n.gate_pass_number||n.id}.pdf`,children:({loading:a})=>e.jsx(H,{title:"Download Gate Pass PDF",onClick:a?void 0:()=>{}})}),e.jsx(W,{onClick:()=>B(n.id)})]})})]},n.id))})]}),x()]})]})};export{xe as default};
