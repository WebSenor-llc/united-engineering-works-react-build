import{u as C,r as c,a as I,j as t,A as b,h as f,e as x,y as T}from"./index-jDfkN2r4.js";import{L as R}from"./ListWrapper-CdcYWlKR.js";import{T as N,a as v,b as o}from"./TableWrapper-BjLYclM7.js";import{T as w}from"./TableRow-saOpsf4I.js";import{u as L}from"./usePagination-DCcA-7np.js";import{T as $}from"./TableActions-CJhLK9s8.js";import{T as k}from"./TableEdit-CoG230zd.js";import{T as M}from"./TableDelete-BoG9eQR7.js";import{C as O}from"./CommonFilter-CtbhRV7S.js";import"./index.esm-DafRD7gC.js";import"./TextInput-BI1n9-MI.js";const X=()=>{const{page:i,rowsPerPage:d,setTotal:y,renderPagination:j}=L(),m=C(),[D,E]=c.useState([]),{user:p,selectedBranchId:_}=I(),[u,P]=c.useState({}),g=[{name:"mr_number",label:"MR Number",placeholder:"Enter MR Number"},{name:"date_from",label:"Date From",type:"date"},{name:"date_to",label:"Date To",type:"date"}],F=e=>{if(!e)return{ymd:"",dmy:""};const[a]=e.split("T"),[s,r,l]=a.split("-");return{ymd:a,dmy:`${l}-${r}-${s}`}},n=async e=>{try{const a=_||p?.branch_id,s={page:i+1,rowsPerPage:d,...a&&{branch_id:a}};e&&(e.mr_number&&(s.mr_number=e.mr_number),e.date_from&&e.date_to?e.date_from===e.date_to?s.date=e.date_from:(s.date_from=e.date_from,s.date_to=e.date_to):(e.date_from&&(s.date_from=e.date_from),e.date_to&&(s.date_to=e.date_to)));const r=await f.get(x.deposit_slip.items,{params:s}),l=r.data?.slips||[],h=r.data?.pagination;E(l),h?.total!==void 0&&y(h.total)}catch(a){console.error("Failed to fetch deposit slips",a)}};c.useEffect(()=>{n(u)},[i,d,_,p]);const S=async e=>{P(e),await n(e)},A=async e=>{try{await f.delete(x.deposit_slip.delete(e)),T.success("Deposit slip deleted successfully"),n()}catch(a){console.error("Failed to delete deposit slip",a),T.error("Failed to delete deposit slip")}};return t.jsxs("div",{className:"space-y-6",children:[t.jsx(O,{fields:g,onFilter:S,defaultValues:u}),t.jsxs(R,{title:"Deposite Slip",createOnClick:()=>m(b.DEPOSITE_SLIP.CREATE),children:[t.jsxs(N,{children:[t.jsx(v,{cols:[{title:"Date"},{title:"Deposited From"},{title:"MR Number"},{title:"Deposited To"},{title:"Actions"}]}),t.jsx("tbody",{children:D.map((e,a)=>t.jsxs(w,{children:[t.jsx(o,{className:"px-5",children:i*d+a+1}),t.jsx(o,{children:F(e.created_at).dmy}),t.jsx(o,{children:e?.depositor?.full_name}),t.jsx(o,{children:e.material_requisition?.mr_number}),t.jsx(o,{children:e.recieved_by}),t.jsx(o,{children:t.jsxs($,{children:[t.jsx(k,{onClick:()=>m(`${b.DEPOSITE_SLIP.CREATE}?editId=${e.id}`)}),t.jsx(M,{onClick:()=>A(e.id)})]})})]},e.id))})]}),j()]})]})};export{X as default};
