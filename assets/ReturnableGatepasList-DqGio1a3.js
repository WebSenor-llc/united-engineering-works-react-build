import{u as R,a as D,r,j as t,A as f,h as g,e as h,y as i}from"./index-BqqV9Doo.js";import{L as N}from"./ListWrapper-D9DKonPA.js";import{T as F,a as S,b as s}from"./TableWrapper-Dr5qitQ3.js";import{T as w}from"./TableRow-DYt9tztm.js";import{u as G}from"./usePagination-Lo4izAnu.js";import{T as v}from"./TableActions-C92COUT2.js";import{T as V}from"./TableDelete-DQwAF_YD.js";import{T as C}from"./TableView-hAORaM58.js";import{L as B}from"./Loading-BaaqrCBr.js";import{C as k}from"./CommonFilter-2chQ1yAo.js";import"./index.esm-C76jvnML.js";import"./TextInput-Cuao9tkr.js";const X=()=>{const{page:o,rowsPerPage:l,setTotal:x,renderPagination:b}=G(),j=R(),{selectedBranchId:d}=D(),[c,T]=r.useState([]),[y,m]=r.useState(!1),[p,P]=r.useState({}),A=[{name:"date_from",label:"Date From",type:"date"},{name:"date_to",label:"Date To",type:"date"}],n=async e=>{m(!0);try{const a={page:o+1,rowsPerPage:l,branch_id:d};e&&(e.date_from&&e.date_to?e.date_from===e.date_to?a.date=e.date_from:(a.date_from=e.date_from,a.date_to=e.date_to):(e.date_from&&(a.date_from=e.date_from),e.date_to&&(a.date_to=e.date_to)));const u=await g.get(h.returnable_gate_pass.items,{params:a}),_=u.data?.pagination;T(u.data.gate_passes||[]),_?.total!==void 0&&x(_.total)}catch(a){console.error("Error fetching gate passes:",a),i.error("Failed to load returnable gate passes")}finally{m(!1)}};r.useEffect(()=>{n(p)},[o,l,d]);const E=async e=>{P(e),await n(e)},L=async e=>{try{await g.delete(h.returnable_gate_pass.delete(e)),i.success("Returnable gate pass deleted successfully"),n()}catch(a){console.error("Failed to delete gate pass",a),i.error(a?.response?.data?.message||"Failed to delete returnable gate pass")}};return t.jsxs("div",{className:"space-y-6",children:[t.jsx(k,{fields:A,onFilter:E,defaultValues:p}),t.jsxs(N,{title:"Returnable GatePass List",createOnClick:()=>j(f.RETURNABLE_GATEPAS.CREATE),children:[y?t.jsx("div",{className:"flex justify-center py-10",children:t.jsx(B,{})}):t.jsxs(F,{children:[t.jsx(S,{cols:[{title:"Date"},{title:"Party Name"},{title:"Purpose"},{title:"Vehicle Number"},{title:"Action"}]}),t.jsx("tbody",{children:c.length===0?t.jsx("tr",{children:t.jsx("td",{colSpan:6,className:"text-center py-8 text-gray-500",children:"No returnable gate passes found"})}):c.map((e,a)=>t.jsxs(w,{children:[t.jsx(s,{className:"px-5",children:o*l+a+1}),t.jsx(s,{children:new Date(e.gate_pass_date||e.created_at||"").toLocaleDateString()}),t.jsx(s,{children:e.party_name}),t.jsx(s,{children:e.purpose}),t.jsx(s,{children:e.vehicle_number}),t.jsx(s,{children:t.jsxs(v,{children:[t.jsx(C,{url:`${f.RETURNABLE_GATEPAS.DETAILS.replace(":id","")}${e.id}`,tooltip:"View Returnable Gate Pass Details"}),t.jsx(V,{onClick:()=>L(e.id)})]})})]},e.id))})]}),b()]})]})};export{X as default};
