import{u as A,r as c,a as N,j as t,A as R,h,e as b,y as f}from"./index-CJSsBkhT.js";import{L as v}from"./ListWrapper-B-2AH1s6.js";import{T as w,a as C,b as o}from"./TableWrapper-Dj27ssIq.js";import{T as I}from"./TableRow-DSWYAKtL.js";import{u as L}from"./usePagination-iM4RzRER.js";import{T as M}from"./TableActions-DOn7XnR-.js";import{T as V}from"./TableDelete-DvDgU1bD.js";import{C as $}from"./CommonFilter-DxiTwGUQ.js";import"./index.esm-BT8ElwEF.js";import"./TextInput-BOX4cYB8.js";const Q=()=>{const{page:i,rowsPerPage:d,setTotal:x,renderPagination:y}=L(),j=A(),[T,D]=c.useState([]),{user:m,selectedBranchId:p}=N(),[u,P]=c.useState({}),g=[{name:"mr_number",label:"MR Number",placeholder:"Enter MR Number"},{name:"date_from",label:"Date From",type:"date"},{name:"date_to",label:"Date To",type:"date"}],F=e=>{if(!e)return{ymd:"",dmy:""};const[a]=e.split("T"),[s,r,l]=a.split("-");return{ymd:a,dmy:`${l}-${r}-${s}`}},n=async e=>{try{const a=p||m?.branch_id,s={page:i+1,rowsPerPage:d,...a&&{branch_id:a}};e&&(e.mr_number&&(s.mr_number=e.mr_number),e.date_from&&e.date_to?e.date_from===e.date_to?s.date=e.date_from:(s.date_from=e.date_from,s.date_to=e.date_to):(e.date_from&&(s.date_from=e.date_from),e.date_to&&(s.date_to=e.date_to)));const r=await h.get(b.deposit_slip.items,{params:s}),l=r.data?.slips||[],_=r.data?.pagination;D(l),_?.total!==void 0&&x(_.total)}catch(a){console.error("Failed to fetch deposit slips",a)}};c.useEffect(()=>{n(u)},[i,d,p,m]);const E=async e=>{P(e),await n(e)},S=async e=>{try{await h.delete(b.deposit_slip.delete(e)),f.success("Deposit slip deleted successfully"),n()}catch(a){console.error("Failed to delete deposit slip",a),f.error("Failed to delete deposit slip")}};return t.jsxs("div",{className:"space-y-6",children:[t.jsx($,{fields:g,onFilter:E,defaultValues:u}),t.jsxs(v,{title:"Deposite Slip",createOnClick:()=>j(R.DEPOSITE_SLIP.CREATE),children:[t.jsxs(w,{children:[t.jsx(C,{cols:[{title:"Date"},{title:"Deposited From"},{title:"MR Number"},{title:"Deposited To"},{title:"Actions"}]}),t.jsx("tbody",{children:T.map((e,a)=>t.jsxs(I,{children:[t.jsx(o,{className:"px-5",children:i*d+a+1}),t.jsx(o,{children:F(e.created_at).dmy}),t.jsx(o,{children:e?.depositor?.full_name}),t.jsx(o,{children:e.material_requisition?.mr_number}),t.jsx(o,{children:e.recieved_by}),t.jsx(o,{children:t.jsx(M,{children:t.jsx(V,{onClick:()=>S(e.id)})})})]},e.id))})]}),y()]})]})};export{Q as default};
