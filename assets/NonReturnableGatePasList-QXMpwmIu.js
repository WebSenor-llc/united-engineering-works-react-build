import{u as L,r as n,a as D,j as t,A as G,h as x,e as j,y as m}from"./index-BEme_EUt.js";import{L as R}from"./ListWrapper-BEjqc6VH.js";import{T as v,a as C,b as r}from"./TableWrapper-xBC1zAYs.js";import{T as S}from"./TableRow-ZxJSRXVE.js";import{u as w}from"./usePagination-ncXkOQbX.js";import{T as V}from"./TableActions-D4JklVjJ.js";import{T as $}from"./TableDelete-Bx4Sru7-.js";import{L as k}from"./Loading-Dz3FfgiZ.js";import{C as B}from"./CommonFilter-D4cDUEMy.js";import"./index.esm-Byko3XjL.js";import"./TextInput-DHAOM3Cm.js";const X=()=>{const{page:l,rowsPerPage:d,setTotal:y,renderPagination:b}=w(),g=L(),[p,u]=n.useState([]),[T,f]=n.useState(!1),{selectedBranchId:h}=D(),[i,N]=n.useState({}),P=[{name:"date_from",label:"Date From",type:"date"},{name:"date_to",label:"Date To",type:"date"}],A=a=>{if(!a)return"";const[e]=a.split("T"),[s,o,c]=e.split("-");return`${c}-${o}-${s}`};n.useEffect(()=>{(async e=>{f(!0);try{const s={page:l+1,rowsPerPage:d,branch_id:h};e&&(e.date_from&&e.date_to?e.date_from===e.date_to?s.date=e.date_from:(s.date_from=e.date_from,s.date_to=e.date_to):(e.date_from&&(s.date_from=e.date_from),e.date_to&&(s.date_to=e.date_to)));const o=await x.get(j.non_returnable_gate_pass.items,{params:s}),c=o.data?.gate_passes||o.data?.data||o.data||[],_=o.data?.pagination;u(c),_?.total!==void 0&&y(_.total)}catch(s){console.error("Failed to fetch non-returnable gate passes",s),m.error("Failed to load gate passes")}finally{f(!1)}})(i)},[l,d,h,i]);const F=async a=>{N(a)},E=async a=>{try{await x.delete(j.non_returnable_gate_pass.delete(a)),u(e=>e.filter(s=>s.id!==a)),m.success("Gate pass deleted successfully")}catch(e){console.error("Failed to delete gate pass",e),m.error("Failed to delete gate pass")}};return t.jsxs("div",{className:"space-y-6",children:[t.jsx(B,{fields:P,onFilter:F,defaultValues:i}),t.jsxs(R,{title:"Non Returnable Gate Pass List",createOnClick:()=>g(G.NON_RETURNABLE_GATEPAS.CREATE),children:[T?t.jsx("div",{className:"flex justify-center py-10",children:t.jsx(k,{})}):t.jsxs(v,{children:[t.jsx(C,{cols:[{title:"Date"},{title:"Party Name"},{title:"Purpose"},{title:"Vehicle Number"},{title:"Actions"}]}),t.jsx("tbody",{children:p.length===0?t.jsx("tr",{children:t.jsx("td",{colSpan:6,className:"text-center py-8 text-gray-500",children:"No gate passes found"})}):p.map((a,e)=>t.jsxs(S,{children:[t.jsx(r,{className:"px-5",children:l*d+e+1}),t.jsx(r,{children:A(a.created_at||a.date)}),t.jsx(r,{children:a.party_name||"-"}),t.jsx(r,{children:a.purpose||"-"}),t.jsx(r,{children:a.vehicle_number||"-"}),t.jsx(r,{children:t.jsx(V,{children:t.jsx($,{onClick:()=>E(a.id)})})})]},a.id))})]}),b()]})]})};export{X as default};
