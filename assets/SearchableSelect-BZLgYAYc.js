import{r as t,j as r,T as z,l as O}from"./index-K9d2s2ak.js";const F=t.forwardRef(({options:v,value:y,onChange:E,placeholder:S="Select",disabled:m,error:u,className:j,onSearch:g,loading:i},N)=>{const[s,n]=t.useState(!1),[o,c]=t.useState(""),[a,R]=t.useState(""),[f,L]=t.useState({top:0,left:0,width:0}),d=t.useRef(null),b=t.useRef(null),C=t.useRef(null);t.useImperativeHandle(N,()=>({close:()=>{n(!1),c("")}}));const p=v??[],D=p.find(e=>e.value===y);t.useEffect(()=>{if(!o||o.length<3)return;const e=setTimeout(()=>{R(o),g?.(o)},300);return()=>clearTimeout(e)},[o,g]);const w=a.length>=3?p.filter(e=>e.label.toLowerCase().includes(a.toLowerCase())):p,l=()=>{if(d.current){const e=d.current.getBoundingClientRect();L({top:e.bottom+window.scrollY,left:e.left+window.scrollX,width:e.width})}};t.useEffect(()=>(s&&(l(),window.addEventListener("resize",l),window.addEventListener("scroll",l,!0)),()=>{window.removeEventListener("resize",l),window.removeEventListener("scroll",l,!0)}),[s]),t.useEffect(()=>{const e=x=>{const h=x.target,T=d.current?.contains(h),k=b.current?.contains(h);!T&&!k&&(n(!1),c(""))};return s&&document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[s]);const I=()=>s?o:D?.label||"";return r.jsxs("div",{className:"relative w-full",ref:d,children:[r.jsx("input",{ref:C,type:"text",disabled:m,value:I(),placeholder:S,onFocus:()=>{n(!0)},onChange:e=>{c(e.target.value),n(!0)},className:O("disabled:cursor-not-allowed disabled:opacity-80 w-full rounded-lg border px-4 py-3 text-gray-900 focus:outline-none text-sm",u?"border-red-500 focus:ring-2 focus:ring-red-200":"border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-500","bg-gray-50",j)}),s&&!m&&z.createPortal(r.jsxs("div",{ref:b,className:"absolute z-[50] rounded-lg border border-gray-300 bg-white shadow-lg max-h-60 overflow-auto",style:{top:f.top+4,left:f.left,width:f.width,boxShadow:"0 10px 25px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)"},children:[i&&r.jsxs("div",{className:"px-4 py-2 text-sm text-gray-600 flex items-center gap-2",children:[r.jsx("div",{className:"w-4 h-4 border-2 border-gray-600 border-t-transparent rounded-full animate-spin"}),"Searching..."]}),a.length>0&&a.length<3&&!i&&r.jsx("div",{className:"px-4 py-2 text-sm text-gray-500",children:"Type at least 3 characters"}),a.length>=3&&w.length===0&&!i&&r.jsx("div",{className:"px-4 py-2 text-sm text-gray-500",children:"No results found"}),w.map(e=>r.jsx("div",{className:"px-4 py-2 text-sm cursor-pointer hover:bg-blue-50 border-b border-gray-100 last:border-b-0",onMouseDown:x=>{x.preventDefault()},onClick:()=>{E(e.value),n(!1),c("")},children:e.label},e.value))]}),document.body),u&&r.jsx("p",{className:"text-xs text-red-500 mt-1 font-medium",children:u})]})});export{F as S};
