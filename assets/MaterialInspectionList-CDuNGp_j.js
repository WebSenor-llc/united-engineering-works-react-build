const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/react-pdf.browser-DkZyG-F3.js","assets/index-CW8Rk0MY.js","assets/index-BuVjEwMM.css","assets/MaterialInspectionReportPDF-DF2Nl95z.js"])))=>i.map(i=>d[i]);
import{u as L,a as v,r as p,j as e,D as A,P as u,A as j,_,y as g,e as m,h as P}from"./index-CW8Rk0MY.js";import{L as M}from"./ListWrapper-CotDcpGz.js";import{T as o}from"./TableData-CtLrfyEs.js";import{T as F,a as k}from"./TableWrapper-DMoDgotN.js";import{T as O}from"./TableRow-DaThW2-k.js";import{u as S}from"./usePagination-BKtm9DsC.js";import{T as C}from"./TableActions-BzLb90yG.js";import{T as U}from"./TableDelete-CcR9XJBA.js";import{T as V,a as B}from"./TableDownload-DwDV3g4m.js";const Y=()=>{const{page:i,rowsPerPage:n,setTotal:T,renderPagination:y}=S(),D=L(),{selectedBranchId:c}=v(),[x,b]=p.useState([]),[R,E]=p.useState(!0),w=async t=>{try{const a=await P.get(m.material_inspection_report.details(t));return a.data?.report||a.data?.data||a.data}catch(a){return console.error("Error fetching report for PDF:",a),g.error("Failed to fetch report details for PDF"),null}},h=async()=>{try{const t=await P.get(m.material_inspection_report.items,{params:{page:i+1,per_page:n,...c&&{branch_id:c}}}),a=t.data?.reports||[],r=t.data?.pagination;b(a),r?.last_page!==void 0&&T(r.last_page)}catch(t){console.error("Error fetching material inspection reports:",t)}finally{E(!1)}};return p.useEffect(()=>{h()},[i,n,c]),e.jsxs(M,{title:"Material Inspection Reports",createOnClick:u.hasPermission("material_inspection_create")?()=>D(j.MATERIAL_INSPECTION_REPORT.CREATE):void 0,children:[e.jsxs(F,{children:[e.jsx(k,{cols:[{title:"Date"},{title:"Department From"},{title:"M/S"},{title:"Actions"}]}),e.jsx("tbody",{children:R?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center p-4",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-red-600"}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Loading material inspection reports..."})]})})}):x.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center py-8",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("svg",{className:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No inspection reports"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Get started by creating a new material inspection report."})]})})}):x.map((t,a)=>e.jsxs(O,{children:[e.jsx(o,{className:"px-5",children:i*n+a+1}),e.jsx(o,{children:e.jsx("span",{className:"text-sm text-gray-900",children:A.date(t.created_at)})}),e.jsx(o,{children:e.jsx("span",{className:"text-sm text-gray-900",children:t.from_department})}),e.jsx(o,{children:e.jsx("span",{className:"text-sm text-gray-900",children:t.ms})}),e.jsx(o,{children:e.jsxs(C,{children:[e.jsx(V,{url:`${j.MATERIAL_INSPECTION_REPORT.DETAILS.replace(":id","")}${t.id}`,tooltip:"View Material Inspection Report Details"}),e.jsx(B,{onClick:async()=>{const r=await w(t.id);if(r)try{const{pdf:l}=await _(async()=>{const{pdf:d}=await import("./react-pdf.browser-DkZyG-F3.js");return{pdf:d}},__vite__mapDeps([0,1,2])),{default:N}=await _(async()=>{const{default:d}=await import("./MaterialInspectionReportPDF-DF2Nl95z.js");return{default:d}},__vite__mapDeps([3,1,2,0])),I=await l(e.jsx(N,{report:r})).toBlob(),f=URL.createObjectURL(I),s=document.createElement("a");s.href=f,s.download=`Material-Inspection-Report-${r.grn_number||t.id}.pdf`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(f)}catch(l){console.error("Error generating PDF:",l),g.error("Failed to generate PDF")}},title:"Download Material Inspection Report PDF"}),u.hasPermission("material_inspection_delete")&&e.jsx(U,{refetch:h,endpoint:m.material_inspection_report.delete(t.id)})]})})]},t.id))})]}),y()]})};export{Y as default};
