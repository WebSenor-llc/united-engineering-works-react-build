import{u as C,i as S,r as o,j as e,B as f,A as p,h as i,e as d,y as m}from"./index-BAaTephW.js";import{T as c}from"./TextInput-DlWsG5tq.js";import{F as w}from"./FormHeader-D2OykZQ7.js";import{L as B}from"./Loading-I9g-LRnp.js";import{o as A,f as E,g as P}from"./yup-c6ABxLcv.js";import{u as F,C as n}from"./index.esm-yOWOhvHM.js";import"./BackButton-C1UvilPF.js";const I={branch_name:"",branch_code:"",phone:"",email:"",address:"",contact_person:"",is_head_office:!1,is_active:!0},D=()=>{const u=C(),[g]=S(),r=g.get("id"),[j,h]=o.useState(!1),[x,b]=o.useState(!1),{control:t,handleSubmit:v,reset:_,formState:{errors:l}}=F({defaultValues:I,resolver:A(r?P:E)}),y=async()=>{if(r){h(!0);try{const s=(await i.get(d.branches.details(Number(r)))).data.branch;_({branch_name:s.branch_name||"",branch_code:s.branch_code||"",phone:s.phone||"",email:s.email||"",address:s.address||"",contact_person:s.contact_person||"",is_head_office:s.is_head_office??!1,is_active:s.is_active??!0})}catch(a){console.error("Failed to load branch details:",a),m.error("Failed to load branch details")}finally{h(!1)}}};o.useEffect(()=>{r&&y()},[r]);const N=async a=>{b(!0);try{const s=r?d.branches.update(Number(r)):d.branches.create;await(r?i.put:i.post)(s,a),m.success(r?"Branch Updated Successfully":"Branch Created Successfully"),u(p.BRANCHES.LIST)}catch(s){console.error(s),m.error(s.response?.data?.message||"Failed to save branch")}finally{b(!1)}};return j?e.jsx("div",{className:"flex justify-center py-20",children:e.jsx(B,{})}):e.jsxs("div",{className:"w-full h-full overflow-auto space-y-8 p-4 pb-20",children:[e.jsx("div",{className:"space-y-1 ml-2",children:e.jsx(w,{title:r?"Edit Branch":"Create Branch",subtitle:r?"Update the branch details":"Fill out the form to create a new branch"})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mx-2",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsx(n,{name:"branch_name",control:t,render:({field:a})=>e.jsx(c,{required:!0,...a,label:"Branch Name",error:l?.branch_name?.message})}),r&&e.jsx(n,{name:"branch_code",control:t,render:({field:a})=>e.jsx(c,{required:!0,...a,label:"Branch Code",error:l?.branch_code?.message,disabled:!!r})}),e.jsx(n,{name:"contact_person",control:t,render:({field:a})=>e.jsx(c,{required:!0,...a,label:"Contact Person",error:l?.contact_person?.message})}),e.jsx(n,{name:"phone",control:t,render:({field:a})=>e.jsx(c,{required:!0,...a,label:"Phone Number",type:"tel",error:l?.phone?.message})}),e.jsx(n,{name:"email",control:t,render:({field:a})=>e.jsx(c,{required:!0,...a,label:"Email",type:"email",error:l?.email?.message})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(n,{name:"address",control:t,render:({field:a})=>e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("label",{className:"text-sm font-semibold text-gray-700 mb-1",children:["Address ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{...a,rows:3,className:"w-full border border-gray-300 rounded-lg px-3 py-3 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",placeholder:"Enter full address"}),l?.address?.message&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.address.message})]})})}),e.jsx(n,{name:"is_head_office",control:t,render:({field:a})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Is Head Office"}),e.jsxs("select",{...a,value:a.value?"true":"false",onChange:s=>a.onChange(s.target.value==="true"),className:"w-full border border-gray-300 rounded-lg px-3 py-3 bg-white text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"false",children:"No"}),e.jsx("option",{value:"true",children:"Yes"})]})]})}),e.jsx(n,{name:"is_active",control:t,render:({field:a})=>e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["Is Active ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{...a,value:a.value?"true":"false",onChange:s=>a.onChange(s.target.value==="true"),className:"w-full border border-gray-300 rounded-lg px-3 py-3 bg-white text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"true",children:"Active"}),e.jsx("option",{value:"false",children:"Inactive"})]})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-8",children:[e.jsx(f,{onClick:()=>u(p.BRANCHES.LIST),variant:"outline",children:"Cancel"}),e.jsx(f,{onClick:v(N),loading:x,disabled:x,className:"bg-red-600 text-white",children:r?"Update Branch":"Create Branch"})]})]})]})};export{D as default};
