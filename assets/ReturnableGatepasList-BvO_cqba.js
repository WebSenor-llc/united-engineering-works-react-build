import{j as e,u as A,a as B,r as x,A as b,h as f,e as C,y as m}from"./index-BrwORqfZ.js";import{L as E}from"./ListWrapper-BaH-EqLI.js";import{T as I,a as L,b as d}from"./TableWrapper-6sipL8t3.js";import{T as P}from"./TableRow-rusg7Z8k.js";import{u as z}from"./usePagination-B-ndTwCk.js";import{T as G}from"./TableActions-CxOZpC0K.js";import{T as V}from"./TableDelete-BqsgYPpv.js";import{T as F}from"./TableView-DJfSE88p.js";import{D as W,P as k,S as H,V as s,I as U,T as l,b as q,a as K}from"./react-pdf.browser-DEu51aZe.js";import{L as O}from"./Loading-BE8U9Iu2.js";import{C as $}from"./CommonFilter-cd2KA1z9.js";import"./index.esm-DAnzzIlF.js";import"./TextInput-BNvsxhCk.js";const Q=i=>i?new Date(i).toLocaleDateString("en-IN",{day:"2-digit",month:"2-digit",year:"numeric"}):"-",J=({gatePass:i})=>{const o=i.items||[];return e.jsx(W,{children:e.jsxs(k,{size:"A4",style:t.page,children:[e.jsxs(s,{style:t.headerContainer,children:[e.jsx(s,{style:t.logoSection,children:e.jsx(U,{src:"/assets/images/logo.png",style:t.logo})}),e.jsxs(s,{style:t.companyInfo,children:[e.jsx(l,{style:t.companyName,children:"UNITED ENGINEERING WORKS"}),e.jsx(l,{style:t.companyAddress,children:"N.H. 8, Nehla Village, By Pass Road, Near Govardhan Vilas, Udaipur- 313001 (Raj.) INDIA"}),e.jsx(l,{style:t.companyContact,children:"Phone: +91-9829232445 +91-9829657145 | GSTIN: 08ABQPK8948J3ZP"}),e.jsx(l,{style:t.companyContact,children:"Email: info@unitedengineeringworks.com"})]})]}),e.jsx(l,{style:t.title,children:"RETURNABLE GATE PASS"}),e.jsxs(s,{style:t.infoContainer,children:[e.jsxs(s,{style:t.gatePassDetailsBox,children:[e.jsxs(s,{style:t.detailRow,children:[e.jsx(l,{style:t.label,children:"Gate Pass No:"}),e.jsx(l,{style:t.value,children:i.gate_pass_number||i.id})]}),e.jsxs(s,{style:t.detailRow,children:[e.jsx(l,{style:t.label,children:"Date:"}),e.jsx(l,{style:t.value,children:Q(i.gate_pass_date||i.created_at||"")})]}),e.jsxs(s,{style:t.detailRow,children:[e.jsx(l,{style:t.label,children:"Branch:"}),e.jsx(l,{style:t.value,children:i.branch?.branch_name||"-"})]}),e.jsxs(s,{style:t.detailRow,children:[e.jsx(l,{style:t.label,children:"Branch Address:"}),e.jsx(l,{style:t.value,children:i.branch?.address||"-"})]}),e.jsxs(s,{style:t.detailRow,children:[e.jsx(l,{style:t.label,children:"Purpose:"}),e.jsx(l,{style:t.value,children:i.purpose||"-"})]})]}),e.jsxs(s,{style:t.partyDetailsBox,children:[e.jsx(l,{style:t.partyTitle,children:"PARTY & VEHICLE DETAILS"}),e.jsxs(s,{style:t.detailRow,children:[e.jsx(l,{style:t.label,children:"Party Name:"}),e.jsx(l,{style:t.value,children:i.party_name||"-"})]}),e.jsxs(s,{style:t.detailRow,children:[e.jsx(l,{style:t.label,children:"Party Address:"}),e.jsx(l,{style:t.value,children:i.party_address||"-"})]}),e.jsxs(s,{style:t.detailRow,children:[e.jsx(l,{style:t.label,children:"Employee Name:"}),e.jsx(l,{style:t.value,children:i.emp_name||"-"})]}),e.jsxs(s,{style:t.detailRow,children:[e.jsx(l,{style:t.label,children:"Employee Address:"}),e.jsx(l,{style:t.value,children:i.emp_address||"-"})]}),e.jsxs(s,{style:t.detailRow,children:[e.jsx(l,{style:t.label,children:"Vehicle No:"}),e.jsx(l,{style:t.value,children:i.vehicle_number||"-"})]}),e.jsxs(s,{style:t.detailRow,children:[e.jsx(l,{style:t.label,children:"Driver Name:"}),e.jsx(l,{style:t.value,children:i.driver_name||"-"})]})]})]}),e.jsxs(s,{style:t.tableContainer,children:[e.jsxs(s,{style:t.tableHeaderRow,children:[e.jsx(s,{style:[t.tableCell,t.snoCol,t.headerCell],children:e.jsx(l,{style:t.headerText,children:"Sr No"})}),e.jsx(s,{style:[t.tableCell,t.descriptionCol,t.headerCell],children:e.jsx(l,{style:t.headerText,children:"Description of Items"})}),e.jsx(s,{style:[t.tableCell,t.codeCol,t.headerCell],children:e.jsx(l,{style:t.headerText,children:"Code"})}),e.jsx(s,{style:[t.tableCell,t.unitCol,t.headerCell],children:e.jsx(l,{style:t.headerText,children:"Unit"})}),e.jsx(s,{style:[t.tableCell,t.qtyCol,t.headerCell],children:e.jsx(l,{style:t.headerText,children:"Qty"})}),e.jsx(s,{style:[t.tableCell,t.remarkCol,t.headerCell],children:e.jsx(l,{style:t.headerText,children:"Remark"})})]}),o.length>0?o.map((n,c)=>e.jsxs(s,{style:t.tableRow,children:[e.jsx(s,{style:[t.tableCell,t.snoCol],children:e.jsx(l,{style:t.cellText,children:c+1})}),e.jsx(s,{style:[t.tableCell,t.descriptionCol],children:e.jsx(l,{style:t.cellText,children:n.item?.item_name||"-"})}),e.jsx(s,{style:[t.tableCell,t.codeCol],children:e.jsx(l,{style:t.cellText,children:n.item?.item_code||"-"})}),e.jsx(s,{style:[t.tableCell,t.unitCol],children:e.jsx(l,{style:t.cellText,children:n.item?.unit?.unit_name||"-"})}),e.jsx(s,{style:[t.tableCell,t.qtyCol],children:e.jsx(l,{style:t.cellText,children:n.quantity_out||0})}),e.jsx(s,{style:[t.tableCell,t.remarkCol],children:e.jsx(l,{style:t.cellText,children:n.item_description||"-"})})]},n.id||c)):e.jsx(s,{style:t.tableRow,children:e.jsx(s,{style:[t.tableCell,{width:"100%"}],children:e.jsx(l,{style:t.cellText,children:"No items found"})})})]}),e.jsx(s,{style:t.vehicleSection,children:e.jsxs(s,{style:t.vehicleRow,children:[e.jsx(l,{style:t.vehicleLabel,children:"Vehicle No: "}),e.jsx(l,{style:t.vehicleValue,children:i.vehicle_number||"____________________"}),e.jsx(l,{style:t.vehicleLabel,children:"Driver: "}),e.jsx(l,{style:t.vehicleValue,children:i.driver_name||"____________________"})]})}),e.jsxs(s,{style:t.signatureContainer,children:[e.jsxs(s,{style:t.signatureBox,children:[e.jsx(l,{style:t.signatureTitle,children:"Prepared by"}),e.jsx(l,{style:t.signatureText,children:i.preparer?.full_name||""}),e.jsx(s,{style:t.signatureLine})]}),e.jsxs(s,{style:t.signatureBox,children:[e.jsx(l,{style:t.signatureTitle,children:"Checked by"}),e.jsx(s,{style:t.signatureLine})]}),e.jsxs(s,{style:t.signatureBox,children:[e.jsx(l,{style:t.signatureTitle,children:"Authorized Signature"}),e.jsx(s,{style:t.signatureLine})]})]}),e.jsx(s,{style:t.footer,children:e.jsx(l,{style:t.footerText,children:"For: UNITED ENGINEERING WORKS, UDAIPUR"})})]})})},t=H.create({page:{padding:20,fontSize:10,fontFamily:"Helvetica",lineHeight:1.3},headerContainer:{flexDirection:"row",alignItems:"center",marginBottom:15,paddingBottom:10,borderBottomWidth:2,borderBottomColor:"#000",gap:10},logoSection:{width:70,marginRight:20},logo:{width:60,height:50},companyInfo:{flex:1,alignItems:"flex-start"},companyName:{fontSize:16,fontWeight:"bold",marginBottom:4},companyAddress:{fontSize:10,marginBottom:2},companyContact:{fontSize:10},title:{fontSize:18,textAlign:"center",marginBottom:15,fontWeight:"bold",textDecoration:"underline"},infoContainer:{flexDirection:"row",marginBottom:15,justifyContent:"space-between"},gatePassDetailsBox:{width:"48%",padding:8,marginTop:10},partyDetailsBox:{width:"48%",padding:8,marginTop:10},partyTitle:{fontSize:11,fontWeight:"bold",marginBottom:5,textAlign:"center"},detailRow:{flexDirection:"row",marginBottom:3},label:{width:"35%",fontSize:9,fontWeight:"bold",marginLeft:0},value:{width:"65%",fontSize:9},tableContainer:{marginBottom:15,borderWidth:1,borderColor:"#000"},tableHeaderRow:{flexDirection:"row",backgroundColor:"#e0e0e0"},tableRow:{flexDirection:"row",minHeight:25},tableCell:{padding:4,borderWidth:.5,borderColor:"#000",justifyContent:"center",alignItems:"center"},headerCell:{backgroundColor:"#f0f0f0"},headerText:{fontSize:9,fontWeight:"bold",textAlign:"center"},cellText:{fontSize:8,textAlign:"center"},snoCol:{width:"8%"},descriptionCol:{width:"35%"},codeCol:{width:"15%"},unitCol:{width:"10%"},qtyCol:{width:"10%"},remarkCol:{width:"22%"},vehicleSection:{marginBottom:20,paddingHorizontal:10},vehicleRow:{flexDirection:"row",alignItems:"center",justifyContent:"flex-start",gap:10},vehicleLabel:{fontSize:10,fontWeight:"bold"},vehicleValue:{fontSize:10,marginRight:30},signatureContainer:{flexDirection:"row",justifyContent:"space-between",marginTop:40,marginBottom:20,paddingHorizontal:20},signatureBox:{width:"30%",alignItems:"center"},signatureTitle:{fontSize:10,fontWeight:"bold",marginBottom:10},signatureLine:{width:120,height:1,backgroundColor:"#000",marginBottom:2},signatureText:{fontSize:9,textAlign:"center"},footer:{alignItems:"center",marginTop:20},footerText:{fontSize:10,fontWeight:"bold"}}),de=()=>{const{page:i,rowsPerPage:o,setTotal:n,renderPagination:c}=z(),T=A(),{selectedBranchId:j}=B(),[g,w]=x.useState([]),[R,u]=x.useState(!1),[p,D]=x.useState({}),S=[{name:"date_from",label:"Date From",type:"date"},{name:"date_to",label:"Date To",type:"date"}],y=async a=>{u(!0);try{const r={page:i+1,rowsPerPage:o,branch_id:j};a&&(a.date_from&&a.date_to?a.date_from===a.date_to?r.date=a.date_from:(r.date_from=a.date_from,r.date_to=a.date_to):(a.date_from&&(r.date_from=a.date_from),a.date_to&&(r.date_to=a.date_to)));const h=await f.get(C.returnable_gate_pass.items,{params:r}),_=h.data?.pagination;w(h.data.gate_passes||[]),_?.total!==void 0&&n(_.total)}catch(r){console.error("Error fetching gate passes:",r),m.error("Failed to load returnable gate passes")}finally{u(!1)}};x.useEffect(()=>{y(p)},[i,o,j]);const v=async a=>{D(a),await y(a)},N=async a=>{try{await f.delete(C.returnable_gate_pass.delete(a)),m.success("Returnable gate pass deleted successfully"),y()}catch(r){console.error("Failed to delete gate pass",r),m.error(r?.response?.data?.message||"Failed to delete returnable gate pass")}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx($,{fields:S,onFilter:v,defaultValues:p}),e.jsxs(E,{title:"Returnable GatePass List",createOnClick:()=>T(b.RETURNABLE_GATEPAS.CREATE),children:[R?e.jsx("div",{className:"flex justify-center py-10",children:e.jsx(O,{})}):e.jsxs(I,{children:[e.jsx(L,{cols:[{title:"Date"},{title:"Party Name"},{title:"Purpose"},{title:"Vehicle Number"},{title:"Action"}]}),e.jsx("tbody",{children:g.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center py-8 text-gray-500",children:"No returnable gate passes found"})}):g.map((a,r)=>e.jsxs(P,{children:[e.jsx(d,{className:"px-5",children:i*o+r+1}),e.jsx(d,{children:new Date(a.gate_pass_date||a.created_at||"").toLocaleDateString()}),e.jsx(d,{children:a.party_name}),e.jsx(d,{children:a.purpose}),e.jsx(d,{children:a.vehicle_number}),e.jsx(d,{children:e.jsxs(G,{children:[e.jsx(F,{url:`${b.RETURNABLE_GATEPAS.DETAILS.replace(":id","")}${a.id}`,tooltip:"View Returnable Gate Pass Details"}),e.jsx(q,{document:e.jsx(J,{gatePass:a}),fileName:`Returnable-Gate-Pass-${a.id}.pdf`,children:({loading:h})=>e.jsx(K,{onClick:()=>{},title:h?"Generating PDF...":"Download PDF"})}),e.jsx(V,{onClick:()=>N(a.id)})]})})]},a.id))})]}),c()]})]})};export{de as default};
