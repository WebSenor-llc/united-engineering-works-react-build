import{u as P,r as p,a as f,h as m,e as h,y as i,j as e,A as g,P as A}from"./index-DhMZcEWH.js";import{L as b}from"./ListWrapper-CgjZDznb.js";import{T as E,a as S,b as a}from"./TableWrapper-oo68n9a4.js";import{T as x}from"./TableRow-BK-4lt1d.js";import{u as y}from"./usePagination-C5ACwfPp.js";import{T as V}from"./TableActions-CbKw7GQR.js";import{T as w}from"./TableEdit-BkrWr8oq.js";import{T as N}from"./TableDelete-CFuZEci9.js";const k=()=>{const{page:o,rowsPerPage:n,setTotal:_,renderPagination:u}=y(),l=P(),[c,T]=p.useState([]),{selectedBranchId:r}=f();p.useEffect(()=>{d()},[o,n,r]);const d=async()=>{try{const t=await m.get(h.visitor_gate_pass.items,{params:{page:o+1,rowsPerPage:n,...r&&{branch_id:r}}}),s=t.data?.pagination;T(t.data.gate_passes||[]),s?.total!==void 0&&_(s.total)}catch(t){console.error("Failed to load visitors",t),i.error("Failed to load visitor gate passes")}},j=async t=>{try{await m.delete(h.visitor_gate_pass.delete(t)),i.success("Visitor gate pass deleted successfully"),d()}catch(s){console.error("Failed to delete visitor gate pass",s),i.error(s?.response?.data?.message||"Failed to delete visitor gate pass")}};return e.jsxs(b,{title:"Visitor GatePass List",createOnClick:A.hasPermission("gate_pass_management_create")?()=>l(g.VISITOR_GATEPASS.CREATE):void 0,children:[e.jsxs(E,{children:[e.jsx(S,{cols:[{title:"Date"},{title:"Name"},{title:"Contact Number"},{title:"Person to Meet"},{title:"Purpose"},{title:"Action"}]}),e.jsx("tbody",{children:c.length===0?e.jsx(x,{children:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center py-5 whitespace-nowrap",children:"No Visitor Gate Pass Records Found"})})}):c.map((t,s)=>e.jsxs(x,{children:[e.jsx(a,{children:s+1}),e.jsx(a,{children:new Date(t.gate_pass_date).toLocaleDateString()}),e.jsx(a,{children:t.visitor_name}),e.jsx(a,{children:t.visitor_contact||"N/A"}),e.jsx(a,{children:t.person_to_meet?.full_name||t.person_to_meet?.username||"N/A"}),e.jsx(a,{children:t.purpose}),e.jsxs(V,{children:[e.jsx(w,{onClick:()=>l(`${g.VISITOR_GATEPASS.CREATE}?editId=${t.id}`)}),e.jsx(N,{onClick:()=>j(t.id)})]})]},t.id))})]}),u()]})};export{k as default};
