import{j as e,u as D,r as p,a as A,A as y,h as g,e as C,y as m}from"./index-pN5-d-m8.js";import{L as E}from"./ListWrapper-CqihWRKm.js";import{T as L,a as N,b as h}from"./TableWrapper-CZQA7s35.js";import{T as B}from"./TableRow-BiiWmwvS.js";import{u as _}from"./usePagination-C2sJmyrq.js";import{T as z}from"./TableActions-DGk_iS9Q.js";import{T as v}from"./TableEdit-DklRpmAs.js";import{T as W}from"./TableDelete-WFkQ4OjU.js";import{D as U,P as k,S as q,V as l,I as F,T as s,a as $,p as H}from"./react-pdf.browser-DCkDMdfZ.js";import{T as V}from"./TableView-DTgWiU07.js";const M=({data:r})=>e.jsx(U,{children:e.jsxs(k,{size:"A4",style:t.page,children:[e.jsxs(l,{style:t.headerContainer,children:[e.jsx(l,{style:t.logoSection,children:e.jsx(F,{src:"/assets/images/logo.png",style:t.logo})}),e.jsx(l,{style:t.companyInfo,children:e.jsx(s,{style:t.companyContact,children:"Phone: 9829232445 | GSTIN: 08ABCPK8948J2P"})})]}),e.jsx(s,{style:t.title,children:"ISSUE SLIP"}),e.jsxs(l,{style:t.infoContainer,children:[e.jsxs(l,{style:t.detailRow,children:[e.jsx(s,{style:t.label,children:"MR:"}),e.jsx(s,{style:t.value,children:r.mr})]}),e.jsxs(l,{style:t.detailRow,children:[e.jsx(s,{style:t.label,children:"Machine:"}),e.jsx(s,{style:t.value,children:r.machine})]}),e.jsxs(l,{style:t.detailRow,children:[e.jsx(s,{style:t.label,children:"For Party:"}),e.jsx(s,{style:t.value,children:r.for_party})]}),e.jsxs(l,{style:t.detailRow,children:[e.jsx(s,{style:t.label,children:"For Mines:"}),e.jsx(s,{style:t.value,children:r.for_mines})]}),e.jsxs(l,{style:t.detailRow,children:[e.jsx(s,{style:t.label,children:"Purpose:"}),e.jsx(s,{style:t.value,children:r.purpose})]})]}),e.jsxs(l,{style:t.tableContainer,children:[e.jsxs(l,{style:t.tableHeaderRow,children:[e.jsx(l,{style:[t.tableCell,t.snoCol],children:e.jsx(s,{style:t.headerText,children:"S.No"})}),e.jsx(l,{style:[t.tableCell,t.itemNameCol],children:e.jsx(s,{style:t.headerText,children:"Item Name"})}),e.jsx(l,{style:[t.tableCell,t.itemCodeCol],children:e.jsx(s,{style:t.headerText,children:"Item Code"})}),e.jsx(l,{style:[t.tableCell,t.unitCol],children:e.jsx(s,{style:t.headerText,children:"Unit"})}),e.jsx(l,{style:[t.tableCell,t.qtyCol],children:e.jsx(s,{style:t.headerText,children:"Required QTY"})}),e.jsx(l,{style:[t.tableCell,t.qtyCol],children:e.jsx(s,{style:t.headerText,children:"Issued QTY"})})]}),r.items.map((n,c)=>e.jsxs(l,{style:t.tableRow,children:[e.jsx(l,{style:[t.tableCell,t.snoCol],children:e.jsx(s,{style:t.cellText,children:c+1})}),e.jsx(l,{style:[t.tableCell,t.itemNameCol],children:e.jsx(s,{style:t.cellText,children:n.item_name})}),e.jsx(l,{style:[t.tableCell,t.itemCodeCol],children:e.jsx(s,{style:t.cellText,children:n.item_code})}),e.jsx(l,{style:[t.tableCell,t.unitCol],children:e.jsx(s,{style:t.cellText,children:n.item_unit})}),e.jsx(l,{style:[t.tableCell,t.qtyCol],children:e.jsx(s,{style:t.cellText,children:n.required_qty})}),e.jsx(l,{style:[t.tableCell,t.qtyCol],children:e.jsx(s,{style:t.cellText,children:n.issued_qty})})]},c))]}),e.jsx(l,{style:t.signatureContainer,children:e.jsxs(l,{style:t.signatureBox,children:[e.jsx(s,{style:t.signatureTitle,children:"For: UNITED ENGINEERING WORKS"}),e.jsx(l,{style:t.signatureLine}),e.jsx(s,{style:t.signatureText,children:"Authorized Signatory"})]})})]})}),t=q.create({page:{padding:20,fontSize:10,fontFamily:"Helvetica",lineHeight:1.3},headerContainer:{flexDirection:"row",alignItems:"center",marginBottom:15,gap:15,borderBottomWidth:2,borderBottomColor:"#000",paddingBottom:8},logoSection:{width:"20%"},logo:{width:90,height:50},companyInfo:{width:"80%",paddingLeft:10},companyName:{fontSize:14,fontWeight:"bold"},companyAddress:{fontSize:9},companyContact:{fontSize:9},title:{fontSize:16,textAlign:"center",marginVertical:10,fontWeight:"bold",textDecoration:"underline"},infoContainer:{marginBottom:15},detailRow:{flexDirection:"row",marginBottom:3},label:{width:"25%",fontSize:9,fontWeight:"bold"},value:{width:"75%",fontSize:9},tableContainer:{borderWidth:.25,borderColor:"#000",marginBottom:20},tableHeaderRow:{flexDirection:"row",backgroundColor:"#e0e0e0"},tableRow:{flexDirection:"row"},tableCell:{borderWidth:.25,borderColor:"#000",padding:2,justifyContent:"center",alignItems:"center"},headerText:{fontSize:9,fontWeight:"bold",textAlign:"center"},cellText:{fontSize:8,textAlign:"center"},snoCol:{width:"8%"},itemNameCol:{width:"30%"},itemCodeCol:{width:"20%"},unitCol:{width:"12%"},qtyCol:{width:"15%"},signatureContainer:{marginTop:40,alignItems:"flex-end"},signatureBox:{width:200,alignItems:"center"},signatureTitle:{fontSize:10,fontWeight:"bold",marginBottom:25},signatureLine:{width:150,height:1,backgroundColor:"#000",marginBottom:5},signatureText:{fontSize:9}}),le=()=>{const{page:r,rowsPerPage:n,setTotal:c,renderPagination:b}=_(),j=D(),[f,T]=p.useState([]),{user:w,selectedBranchId:x}=A(),S=i=>{if(!i)return{ymd:"",dmy:""};const[o]=i.split("T"),[a,d,P]=o.split("-");return{ymd:o,dmy:`${P}-${d}-${a}`}},u=async()=>{try{const i=await g.get(C.issue_slips.items,{params:{page:r+1,rowsPerPage:n,...x&&{branch_id:x}}}),o=i.data?.data?.slips||i.data?.slips||[],a=i.data?.pagination;T(o),a?.total!==void 0&&c(a.total)}catch(i){console.error("Failed to fetch issue slips",i)}};p.useEffect(()=>{u()},[r,n,x,w]);const I=async i=>{try{const o=await H(e.jsx(M,{data:i})).toBlob(),a=URL.createObjectURL(o),d=document.createElement("a");d.href=a,d.download=`issue-slip-${i.id||"unknown"}.pdf`,d.click(),URL.revokeObjectURL(a)}catch(o){console.error("Failed to download issue slip",o),m.error("Failed to download issue slip")}},R=async i=>{try{await g.delete(C.issue_slips.delete(i)),m.success("Issue slip deleted successfully"),u()}catch(o){console.error("Failed to delete issue slip",o),m.error("Failed to delete issue slip")}};return e.jsxs(E,{title:"Issue Slip List",createOnClick:()=>j(y.ISSUE_SLIP.CREATE),children:[e.jsxs(L,{children:[e.jsx(N,{cols:[{title:"Date"},{title:"Issued to MR"},{title:"Purpose"},{title:"Actions"}]}),e.jsx("tbody",{children:f.map((i,o)=>e.jsxs(B,{children:[e.jsx(h,{className:"px-5",children:o+1}),e.jsx(h,{children:S(i.created_at).dmy}),e.jsx(h,{children:i?.mr||"N/A"}),e.jsx(h,{children:i.purpose||"N/A"}),e.jsxs(z,{children:[e.jsx(V,{url:`${y.ISSUE_SLIP.DETAILS.replace(":id","")}${i.id}`,tooltip:"View Issue Slip Details"}),e.jsx($,{title:"Download Issue slip",onClick:()=>I(i)}),e.jsx(v,{onClick:()=>j(`${y.ISSUE_SLIP.CREATE}?editId=${i.id}`)}),e.jsx(W,{onClick:()=>R(Number(i.id))})]})]},i.id))})]}),b()]})};export{le as default};
