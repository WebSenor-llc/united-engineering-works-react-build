import{u as j,r as p,a as P,h as m,e as h,y as i,j as e,A as g,P as f}from"./index-B2Kq7pF4.js";import{L as A}from"./ListWrapper-BCNScaty.js";import{T as b,a as E,b as a}from"./TableWrapper-jqHXbh_L.js";import{T as S}from"./TableRow-BJlAj-zV.js";import{u as y}from"./usePagination-Cnfjy3pF.js";import{T as V}from"./TableActions-v4FwT6Lt.js";import{T as w}from"./TableEdit-DKIDQymF.js";import{T as N}from"./TableDelete-DKVpIjq0.js";const k=()=>{const{page:o,rowsPerPage:n,setTotal:x,renderPagination:_}=y(),l=j(),[c,u]=p.useState([]),{selectedBranchId:r}=P();p.useEffect(()=>{d()},[o,n,r]);const d=async()=>{try{const t=await m.get(h.visitor_gate_pass.items,{params:{page:o+1,rowsPerPage:n,...r&&{branch_id:r}}}),s=t.data?.pagination;u(t.data.gate_passes||[]),s?.total!==void 0&&x(s.total)}catch(t){console.error("Failed to load visitors",t),i.error("Failed to load visitor gate passes")}},T=async t=>{try{await m.delete(h.visitor_gate_pass.delete(t)),i.success("Visitor gate pass deleted successfully"),d()}catch(s){console.error("Failed to delete visitor gate pass",s),i.error(s?.response?.data?.message||"Failed to delete visitor gate pass")}};return e.jsxs(A,{title:"Visitor GatePass List",createOnClick:f.hasPermission("gate_pass_management_create")?()=>l(g.VISITOR_GATEPASS.CREATE):void 0,children:[e.jsxs(b,{children:[e.jsx(E,{cols:[{title:"Date"},{title:"Name"},{title:"Contact Number"},{title:"Person to Meet"},{title:"Purpose"},{title:"Action"}]}),e.jsx("tbody",{children:c.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center py-5 whitespace-nowrap",children:"No Visitor Gate Pass Records Found"})}):c.map((t,s)=>e.jsxs(S,{children:[e.jsx(a,{children:s+1}),e.jsx(a,{children:new Date(t.gate_pass_date).toLocaleDateString()}),e.jsx(a,{children:t.visitor_name}),e.jsx(a,{children:t.visitor_contact||"N/A"}),e.jsx(a,{children:t.person_to_meet?.full_name||t.person_to_meet?.username||"N/A"}),e.jsx(a,{children:t.purpose}),e.jsx(a,{children:e.jsxs(V,{children:[e.jsx(w,{onClick:()=>l(`${g.VISITOR_GATEPASS.CREATE}?editId=${t.id}`)}),e.jsx(N,{onClick:()=>T(t.id)})]})})]},t.id))})]}),_()]})};export{k as default};
