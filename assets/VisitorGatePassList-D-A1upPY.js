import{u as j,r as d,a as P,h as p,e as m,y as i,j as e,P as T,A as f}from"./index-BqqV9Doo.js";import{L as A}from"./ListWrapper-D9DKonPA.js";import{T as b,a as y,b as a}from"./TableWrapper-Dr5qitQ3.js";import{T as w}from"./TableRow-DYt9tztm.js";import{u as N}from"./usePagination-Lo4izAnu.js";import{T as S}from"./TableActions-C92COUT2.js";import{T as V}from"./TableDelete-DQwAF_YD.js";const G=()=>{const{page:o,rowsPerPage:n,setTotal:h,renderPagination:g}=N(),x=j(),[l,u]=d.useState([]),{selectedBranchId:r}=P();d.useEffect(()=>{c()},[o,n,r]);const c=async()=>{try{const t=await p.get(m.visitor_gate_pass.items,{params:{page:o+1,rowsPerPage:n,...r&&{branch_id:r}}}),s=t.data?.pagination;u(t.data.gate_passes||[]),s?.total!==void 0&&h(s.total)}catch(t){console.error("Failed to load visitors",t),i.error("Failed to load visitor gate passes")}},_=async t=>{try{await p.delete(m.visitor_gate_pass.delete(t)),i.success("Visitor gate pass deleted successfully"),c()}catch(s){console.error("Failed to delete visitor gate pass",s),i.error(s?.response?.data?.message||"Failed to delete visitor gate pass")}};return e.jsxs(A,{title:"Visitor GatePass List",createOnClick:T.hasPermission("gate_pass_management_create")?()=>x(f.VISITOR_GATEPASS.CREATE):void 0,children:[e.jsxs(b,{children:[e.jsx(y,{cols:[{title:"Date"},{title:"Name"},{title:"Contact Number"},{title:"Person to Meet"},{title:"Purpose"},{title:"Action"}]}),e.jsx("tbody",{children:l.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center py-5 whitespace-nowrap",children:"No Visitor Gate Pass Records Found"})}):l.map((t,s)=>e.jsxs(w,{children:[e.jsx(a,{children:s+1}),e.jsx(a,{children:new Date(t.gate_pass_date).toLocaleDateString()}),e.jsx(a,{children:t.visitor_name}),e.jsx(a,{children:t.visitor_contact||"N/A"}),e.jsx(a,{children:t.person_to_meet?.full_name||t.person_to_meet?.username||"N/A"}),e.jsx(a,{children:t.purpose}),e.jsx(a,{children:e.jsx(S,{children:e.jsx(V,{onClick:()=>_(t.id)})})})]},t.id))})]}),g()]})};export{G as default};
