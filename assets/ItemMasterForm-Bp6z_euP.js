import{u as C,i as S,a as k,r as p,j as e,B as j,h as c,e as m,y as x}from"./index-B2Kq7pF4.js";import{u as w,C as n}from"./index.esm-B19_P2AP.js";import{o as U,i as F,a as A}from"./yup-CzgU9FQc.js";import{T as d}from"./TextInput-D6Nk2HMm.js";import{T as M}from"./TextArea-BgiCoYt6.js";import{L as T}from"./Loading-OOr2nQlv.js";import{F as q}from"./FormHeader-CQNygXHB.js";import"./BackButton-D6lHrR0A.js";const E={item_name:"",description:"",unit_id:"",is_active:!0,current_stock:"",note:""},G=()=>{const _=C(),[h]=S(),r=h.get("editId")?Number(h.get("editId")):void 0,{selectedBranchId:u}=k(),[l,o]=p.useState(!1),[f,v]=p.useState([]),{control:a,handleSubmit:g,reset:b,formState:{errors:i}}=w({defaultValues:E,resolver:U(r?A:F)}),y=async()=>{o(!0);try{const t=await c.get(m.unit_master.units);v(t.data.units)}finally{o(!1)}},I=async()=>{if(r){o(!0);try{const s=(await c.get(m.item_master.details(r))).data.item;b({item_name:s.item_name,item_code:s.item_code,description:s.description,is_active:s.is_active,current_stock:s.current_stock,unit_id:s.unit_id,note:s.note||"",branch_id:u})}finally{o(!1)}}};p.useEffect(()=>{y(),r&&I()},[r]);const N=async t=>{o(!0);try{const s=r?{item_name:t.item_name,description:t.description,is_active:t.is_active,unit_id:t.unit_id,current_stock:t.current_stock,branch_id:u}:{...t,branch_id:u};r?(await c.put(m.item_master.update(r),s),x.success("Item Updated Successfully")):(await c.post(m.item_master.create,s),x.success("Item Created Successfully")),_("/master/item-master/list")}catch(s){console.error(s),x.error(s.response?.data?.message||"Failed to save item")}finally{o(!1)}};return l&&r?e.jsx("div",{className:"flex justify-center py-20",children:e.jsx(T,{})}):e.jsxs("div",{className:"w-full h-full overflow-auto space-y-8 p-4 pb-20",children:[e.jsx("div",{className:"space-y-1 ml-2",children:e.jsx(q,{title:r?"Edit Item Master":"Create Item Master",subtitle:r?"Update the Item Master details":"Fill out the form to submit a new Item Master."})}),e.jsxs("div",{className:"grid grid-cols-3 gap-5 ml-2 mr-5 mt-5",children:[e.jsx(n,{name:"item_name",control:a,render:({field:t})=>e.jsx(d,{required:!0,...t,label:"Item Name",error:i?.item_name?.message})}),r&&e.jsx(n,{name:"item_code",control:a,render:({field:t})=>e.jsx(d,{required:!0,...t,label:"Item Code",error:i?.item_code?.message,disabled:!!r})}),e.jsx(n,{name:"description",control:a,render:({field:t})=>e.jsx(d,{required:!0,...t,label:"Description",error:i?.description?.message})}),e.jsx(n,{name:"unit_id",control:a,render:({field:t})=>e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1",children:"Unit"}),e.jsxs("select",{...t,className:"w-full p-2 border rounded disabled:bg-gray-100",children:[e.jsx("option",{value:"",children:"Select Unit"}),f.filter(s=>s.is_active).map(s=>e.jsx("option",{value:s.id,children:s.unit_name},s.id))]}),i?.unit_id?.message&&e.jsx("p",{className:"text-red-500 text-xs",children:i.unit_id.message})]})}),e.jsx(n,{name:"current_stock",control:a,render:({field:t})=>e.jsx(d,{required:!0,...t,type:"number",label:"Current Stock",error:i?.current_stock?.message})}),e.jsx(n,{name:"is_active",control:a,render:({field:t})=>e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1",children:"Is Active"}),e.jsxs("select",{...t,onChange:s=>t.onChange(s.target.value==="true"),className:"w-full border rounded p-2",value:t.value?"true":"false",children:[e.jsx("option",{value:"true",children:"True"}),e.jsx("option",{value:"false",children:"False"})]})]})})]}),e.jsx("div",{className:"ml-2 mr-5 mt-5",children:e.jsx(n,{name:"note",control:a,render:({field:t})=>e.jsx(M,{...t,label:"Note",placeholder:"Add any additional notes or comments...",rows:3,error:i?.note?.message})})}),e.jsxs("div",{className:"flex justify-end gap-3 mt-5 mr-5",children:[e.jsx(j,{onClick:()=>_("/master/item-master/list"),variant:"outline",disabled:l,children:"Cancel"}),e.jsx(j,{onClick:g(N),loading:l,disabled:l,children:r?"Update Item":"Create Item"})]})]})};export{G as default};
