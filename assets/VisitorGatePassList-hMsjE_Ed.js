import{u as j,r as d,a as P,h as p,e as m,y as i,j as e,P as T,A as f}from"./index-Cq0y9b1s.js";import{L as A}from"./ListWrapper-xeW7rKCk.js";import{T as a}from"./TableData-BXSH2g-s.js";import{T as b,a as y}from"./TableWrapper-BtWMRpLi.js";import{T as w}from"./TableRow-D9ghcJ4Z.js";import{u as N}from"./usePagination-ChBb-y3W.js";import{T as S}from"./TableActions-GlLmetcq.js";import{T as V}from"./TableDelete-Dd8njRNG.js";const I=()=>{const{page:o,rowsPerPage:n,setTotal:g,renderPagination:h}=N(),_=j(),[l,x]=d.useState([]),{selectedBranchId:r}=P();d.useEffect(()=>{c()},[o,n,r]);const c=async()=>{try{const s=await p.get(m.visitor_gate_pass.items,{params:{page:o+1,per_page:n,...r&&{branch_id:r}}}),t=s.data?.pagination;x(s.data.gate_passes||[]),t?.last_page!==void 0&&g(t.last_page)}catch(s){console.error("Failed to load visitors",s),i.error("Failed to load visitor gate passes")}},u=async s=>{try{await p.delete(m.visitor_gate_pass.delete(s)),i.success("Visitor gate pass deleted successfully"),c()}catch(t){console.error("Failed to delete visitor gate pass",t),i.error(t?.response?.data?.message||"Failed to delete visitor gate pass")}};return e.jsxs(A,{title:"Visitor GatePass List",createOnClick:T.hasPermission("gate_pass_management_create")?()=>_(f.VISITOR_GATEPASS.CREATE):void 0,children:[e.jsxs(b,{children:[e.jsx(y,{cols:[{title:"Date"},{title:"Name"},{title:"Contact Number"},{title:"Person to Meet"},{title:"Purpose"},{title:"Action"}]}),e.jsx("tbody",{children:l.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center py-5 whitespace-nowrap",children:"No Visitor Gate Pass Records Found"})}):l.map((s,t)=>e.jsxs(w,{children:[e.jsx(a,{children:t+1}),e.jsx(a,{children:new Date(s.gate_pass_date).toLocaleDateString()}),e.jsx(a,{children:s.visitor_name}),e.jsx(a,{children:s.visitor_contact||"N/A"}),e.jsx(a,{children:s.person_to_meet?.full_name||s.person_to_meet?.username||"N/A"}),e.jsx(a,{children:s.purpose}),e.jsx(a,{children:e.jsx(S,{children:e.jsx(V,{onClick:()=>u(s.id)})})})]},s.id))})]}),h()]})};export{I as default};
