import{j as e,u as L,r as g,a as A,A as f,h as C,e as T,y as D}from"./index-B2jzE3KR.js";import{L as z}from"./ListWrapper-BCPK_3oF.js";import{T as c}from"./TableData-kP0iDjWa.js";import{T as E,a as F}from"./TableWrapper-COpFbzLV.js";import{T as W}from"./TableRow-BTYyu-1e.js";import{u as v}from"./usePagination-LT8jskJh.js";import{T as V}from"./TableActions-BfJ7Aaus.js";import{T as k}from"./TableDelete-BO_nTUXR.js";import{T as H,a as q}from"./TableDownload-CPqqWuAc.js";import{C as $}from"./CommonFilter-CY8kfyCZ.js";import{Document as G,Page as O,StyleSheet as M,View as o,Image as Q,Text as i,PDFDownloadLink as U}from"./react-pdf.browser-UupAjTf3.js";import"./index.esm-BJtmoOhw.js";import"./TextInput-p-2I97j_.js";const K=s=>s?new Date(s).toLocaleDateString("en-IN",{day:"2-digit",month:"2-digit",year:"numeric"}):"-",J=({depositSlip:s})=>{const d=s.items||[];return e.jsx(G,{children:e.jsxs(O,{size:"A4",style:t.page,children:[e.jsxs(o,{style:t.headerContainer,children:[e.jsx(o,{style:t.logoSection,children:e.jsx(Q,{src:"/assets/images/logo.png",style:t.logo})}),e.jsxs(o,{style:t.companyInfo,children:[e.jsx(i,{style:t.companyName,children:"UNITED ENGINEERING WORKS"}),e.jsx(i,{style:t.companyAddress,children:"N.H. 8, Nehla Village, By Pass Road, Near Govardhan Vilas, Udaipur- 313001 (Raj.) INDIA"}),e.jsx(i,{style:t.companyContact,children:"Phone: +91-9829232445 +91-9829657145 | GSTIN: 08ABQPK8948J3ZP"}),e.jsx(i,{style:t.companyContact,children:"Email: info@unitedengineeringworks.com"})]})]}),e.jsx(i,{style:t.title,children:"DEPOSIT SLIP"}),e.jsx(o,{style:t.detailsContainer,children:e.jsxs(o,{style:t.detailRow,children:[e.jsx(i,{style:t.detailLabel,children:"No:"}),e.jsx(i,{style:t.detailValue,children:s.slip_number||`DS-${s.id}`}),e.jsx(i,{style:t.detailLabel,children:"Date:"}),e.jsx(i,{style:t.detailValue,children:K(s.created_at)})]})}),e.jsxs(o,{style:t.itemsSection,children:[e.jsx(i,{style:t.itemsTitle,children:"Please deposit the following items:"}),e.jsxs(o,{style:t.tableContainer,children:[e.jsxs(o,{style:t.tableHeaderRow,children:[e.jsx(o,{style:[t.tableCell,t.snoCol,t.headerCell],children:e.jsx(i,{style:t.headerText,children:"Sr No."})}),e.jsx(o,{style:[t.tableCell,t.itemDescCol,t.headerCell],children:e.jsx(i,{style:t.headerText,children:"Item Description"})}),e.jsx(o,{style:[t.tableCell,t.codeCol,t.headerCell],children:e.jsx(i,{style:t.headerText,children:"Code"})}),e.jsx(o,{style:[t.tableCell,t.unitCol,t.headerCell],children:e.jsx(i,{style:t.headerText,children:"Unit"})}),e.jsx(o,{style:[t.tableCell,t.qtyToDepositCol,t.headerCell],children:e.jsx(i,{style:t.headerText,children:"Qty. to Deposit"})}),e.jsx(o,{style:[t.tableCell,t.qtyDepositedCol,t.headerCell],children:e.jsx(i,{style:t.headerText,children:"Qty. Deposited"})})]}),d.length>0?d.map((r,m)=>e.jsxs(o,{style:t.tableRow,children:[e.jsx(o,{style:[t.tableCell,t.snoCol],children:e.jsx(i,{style:t.cellText,children:m+1})}),e.jsx(o,{style:[t.tableCell,t.itemDescCol],children:e.jsx(i,{style:t.cellText,children:r.item?.item_name||"-"})}),e.jsx(o,{style:[t.tableCell,t.codeCol],children:e.jsx(i,{style:t.cellText,children:r.item?.item_code||"-"})}),e.jsx(o,{style:[t.tableCell,t.unitCol],children:e.jsx(i,{style:t.cellText,children:r.item?.unit?.unit_name||"-"})}),e.jsx(o,{style:[t.tableCell,t.qtyToDepositCol],children:e.jsx(i,{style:t.cellText,children:r.quantity_to_deposit||"0"})}),e.jsx(o,{style:[t.tableCell,t.qtyDepositedCol],children:e.jsx(i,{style:t.cellText,children:r.quantity_deposited||"0"})})]},r.id||m)):e.jsx(o,{style:t.tableRow,children:e.jsx(o,{style:[t.tableCell,{width:"100%"}],children:e.jsx(i,{style:t.cellText,children:"No items found"})})})]})]}),e.jsxs(o,{style:t.reasonSection,children:[e.jsx(i,{style:t.reasonLabel,children:"Reason for depositing the above items:"}),e.jsx(o,{style:t.reasonLine,children:e.jsx(i,{style:t.reasonText,children:s.reason||""})})]}),e.jsx(o,{style:t.noteSection,children:e.jsx(i,{style:t.noteText,children:"Above items to be used in future or not. If use in future then we Stores will take in Stocks otherwise not."})}),e.jsxs(o,{style:t.signatureContainer,children:[e.jsxs(o,{style:t.signatureBox,children:[e.jsx(i,{style:t.signatureTitle,children:"Deposited by"}),e.jsx(i,{style:t.signatureText,children:s.depositor?.full_name||s.deposited_by||""}),e.jsx(o,{style:t.signatureLine})]}),e.jsxs(o,{style:t.signatureBox,children:[e.jsx(i,{style:t.signatureTitle,children:"Received by"}),e.jsx(o,{style:t.signatureLine}),e.jsxs(i,{style:t.signatureText,children:["(",s.recieved_by||"Store",")"]})]})]})]})})},t=M.create({page:{padding:20,fontSize:10,fontFamily:"Helvetica",lineHeight:1.3},headerContainer:{flexDirection:"row",alignItems:"center",marginBottom:15,paddingBottom:10,borderBottomWidth:2,borderBottomColor:"#000",gap:10},logoSection:{width:70,marginRight:20},logo:{width:60,height:50},companyInfo:{flex:1,alignItems:"flex-start"},companyName:{fontSize:16,fontWeight:"bold",marginBottom:4},companyAddress:{fontSize:10,marginBottom:2},companyContact:{fontSize:10},title:{fontSize:18,textAlign:"center",marginBottom:20,fontWeight:"bold",textDecoration:"underline"},detailsContainer:{marginBottom:20},detailRow:{flexDirection:"row",alignItems:"center",gap:20},detailLabel:{fontSize:11,fontWeight:"bold"},detailValue:{fontSize:11,marginRight:40},itemsSection:{marginBottom:20},itemsTitle:{fontSize:11,fontWeight:"bold",marginBottom:10},tableContainer:{borderWidth:1,borderColor:"#000"},tableHeaderRow:{flexDirection:"row",backgroundColor:"#e0e0e0"},tableRow:{flexDirection:"row",minHeight:25},tableCell:{padding:4,borderWidth:.5,borderColor:"#000",justifyContent:"center",alignItems:"center"},headerCell:{backgroundColor:"#f0f0f0"},headerText:{fontSize:9,fontWeight:"bold",textAlign:"center"},cellText:{fontSize:8,textAlign:"center"},snoCol:{width:"8%"},itemDescCol:{width:"35%"},codeCol:{width:"20%"},unitCol:{width:"12%"},qtyToDepositCol:{width:"12%"},qtyDepositedCol:{width:"13%"},reasonSection:{marginBottom:20},reasonLabel:{fontSize:11,fontWeight:"bold",marginBottom:5},reasonLine:{borderBottomWidth:1,borderBottomColor:"#000",minHeight:20,paddingBottom:2},reasonText:{fontSize:10},noteSection:{marginBottom:30},noteText:{fontSize:10,fontStyle:"italic"},signatureContainer:{flexDirection:"row",justifyContent:"space-between",marginTop:40,paddingHorizontal:40},signatureBox:{width:"40%",alignItems:"center"},signatureTitle:{fontSize:11,fontWeight:"bold",marginBottom:30},signatureLine:{width:150,height:1,backgroundColor:"#000",marginBottom:5},signatureText:{fontSize:10,textAlign:"center"}}),ce=()=>{const{page:s,rowsPerPage:d,setTotal:r,renderPagination:m}=v(),_=L(),[S,w]=g.useState([]),{user:p,selectedBranchId:j}=A(),[u,I]=g.useState({}),B=[{name:"mr_number",label:"MR Number",placeholder:"Enter MR Number"},{name:"date_from",label:"Date From",type:"date"},{name:"date_to",label:"Date To",type:"date"}],P=l=>{if(!l)return{ymd:"",dmy:""};const[n]=l.split("T"),[a,h,y]=n.split("-");return{ymd:n,dmy:`${y}-${h}-${a}`}},x=async l=>{try{const n=j||p?.branch_id,a={page:s+1,per_page:d,...n&&{branch_id:n}};l&&(l.mr_number&&(a.mr_number=l.mr_number),l.date_from&&l.date_to?l.date_from===l.date_to?a.date=l.date_from:(a.date_from=l.date_from,a.date_to=l.date_to):(l.date_from&&(a.date_from=l.date_from),l.date_to&&(a.date_to=l.date_to)));const h=await C.get(T.deposit_slip.items,{params:a}),y=h.data?.slips||[],b=h.data?.pagination;w(y),b?.last_page!==void 0&&r(b.last_page)}catch(n){console.error("Failed to fetch deposit slips",n)}};g.useEffect(()=>{x(u)},[s,d,j,p]);const N=async l=>{I(l),await x(l)},R=async l=>{try{await C.delete(T.deposit_slip.delete(l)),D.success("Deposit slip deleted successfully"),x()}catch(n){console.error("Failed to delete deposit slip",n),D.error("Failed to delete deposit slip")}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx($,{fields:B,onFilter:N,defaultValues:u}),e.jsxs(z,{title:"Deposit Slip",createOnClick:()=>_(f.DEPOSITE_SLIP.CREATE),children:[e.jsxs(E,{children:[e.jsx(F,{cols:[{title:"Date"},{title:"Deposited From"},{title:"MR Number"},{title:"Deposited To"},{title:"Actions"}]}),e.jsx("tbody",{children:S.map((l,n)=>e.jsxs(W,{children:[e.jsx(c,{className:"px-5",children:s*d+n+1}),e.jsx(c,{children:P(l.created_at).dmy}),e.jsx(c,{children:l?.depositor?.full_name}),e.jsx(c,{children:l.material_requisition?.mr_number}),e.jsx(c,{children:l.recieved_by}),e.jsx(c,{children:e.jsxs(V,{children:[e.jsx(H,{url:`${f.DEPOSITE_SLIP.DETAILS.replace(":id","")}${l.id}`,tooltip:"View Deposit Slip Details"}),e.jsx(U,{document:e.jsx(J,{depositSlip:l}),fileName:`Deposit-Slip-${l.id}.pdf`,children:({loading:a})=>e.jsx(q,{onClick:()=>{},title:a?"Generating PDF...":"Download PDF"})}),e.jsx(k,{onClick:()=>R(l.id)})]})})]},l.id))})]}),m()]})]})};export{ce as default};
