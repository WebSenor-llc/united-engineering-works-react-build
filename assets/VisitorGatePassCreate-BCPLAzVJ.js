import{u as V,i as I,a as G,r as m,j as e,B as S,A as p,h as u,e as _,y as c}from"./index-DHxjsmS_.js";import{T as l}from"./TextInput-p5Tar9_e.js";import{u as T,C as d}from"./index.esm-O_A2BQbF.js";import{o as A,x as N}from"./yup-BWCmlrJm.js";import{B as C}from"./BranchUserSelect-DOq0GDNn.js";import{L as E}from"./Loading-CxrkmpiL.js";import{F as L}from"./FormHeader-ClhnmCTk.js";const w={name:"",address:"",purpose:"",person_to_meet:"",contact_num:""},M=()=>{const i=V(),[v]=I(),t=v.get("editId"),{selectedBranchId:j}=G(),[P,f]=m.useState(!1),[g,x]=m.useState(!1),{control:r,handleSubmit:b,reset:h,formState:{errors:n}}=T({resolver:A(N),defaultValues:w});m.useEffect(()=>{if(!t)return;(async()=>{f(!0);try{const a=(await u.get(_.visitor_gate_pass.details(parseInt(t,10)))).data?.gate_pass;h({name:a.visitor_name||"",address:a.visitor_address||"",purpose:a.purpose||"",person_to_meet:a.person_to_meet_id?.toString()||"",contact_num:a.visitor_contact||""})}catch(o){console.error(o),c.error("Failed to load visitor gate pass details"),i(p.VISITOR_GATEPASS.LIST)}finally{f(!1)}})()},[t,h,i]);const y=async s=>{const o={visitor_name:s.name,visitor_contact:s.contact_num,purpose:s.purpose,visitor_address:s.address,person_to_meet_id:Number(s.person_to_meet),branch_id:j};try{x(!0),t?(await u.put(_.visitor_gate_pass.update(parseInt(t,10)),o),c.success("Visitor Gate Pass Updated Successfully")):(await u.post(_.visitor_gate_pass.create,o),c.success("Visitor Gate Pass Created Successfully")),i(p.VISITOR_GATEPASS.LIST)}catch(a){console.error(a),c.error(a?.response?.data?.message||`Failed to ${t?"update":"create"} visitor gate pass`)}finally{x(!1)}};return P?e.jsx("div",{className:"flex justify-center py-20",children:e.jsx(E,{})}):e.jsxs("div",{className:"w-full h-full overflow-auto space-y-8 p-4 pb-20",children:[e.jsx("div",{className:"space-y-1 ml-2",children:e.jsx(L,{title:t?"Edit Visitor Gate Pass":"Create Visitor Gate Pass",subtitle:t?"Update the visitor gate pass details":"Fill out the form to create a Visitor Gate Pass"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-5 ml-2 mr-5",children:[e.jsx(d,{name:"name",control:r,render:({field:s})=>e.jsx(l,{...s,label:"Visitor Name",error:n.name?.message})}),e.jsx(d,{name:"contact_num",control:r,render:({field:s})=>e.jsx(l,{...s,label:"Contact Number",type:"tel",pattern:"[0-9]{10}",maxLength:10,placeholder:"Enter 10 digit number",error:n.contact_num?.message})}),e.jsx(d,{name:"address",control:r,render:({field:s})=>e.jsx(l,{...s,label:"Address",error:n.address?.message})}),e.jsx(C,{control:r,name:"person_to_meet",label:"Person To Meet"}),e.jsx(d,{name:"purpose",control:r,render:({field:s})=>e.jsx(l,{...s,label:"Purpose of Visit",error:n.purpose?.message})})]}),e.jsxs("div",{className:"flex justify-end gap-3 mr-5",children:[e.jsx(S,{variant:"outline",onClick:()=>i(p.VISITOR_GATEPASS.LIST),children:"Cancel"}),e.jsx(S,{className:"bg-red-600 text-white",onClick:b(y),loading:g,disabled:g,children:t?"Update Visitor Gate Pass":"Submit Visitor Gate Pass"})]})]})};export{M as default};
