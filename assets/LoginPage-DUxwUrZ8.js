import{u as w,r as j,a as A,j as s,B as S,h as P,e as b,y,P as L,A as k}from"./index-DSLs68fz.js";import{T as m}from"./TextInput-CWb4FDJ1.js";import{L as E}from"./Loading-C52XRUuf.js";import{o as N,l as v}from"./yup-DwIng6A-.js";import{u as D,C as i}from"./index.esm-51NyA9dG.js";const B={username:"",password:""},I=()=>{const u=w(),[d,o]=j.useState(!1),c=A(e=>e.setAuth),{control:t,handleSubmit:p,formState:{errors:n}}=D({defaultValues:B,resolver:N(v)}),g=async e=>{const r=new FormData;r.append("username",e.username),r.append("password",e.password),o(!0);try{const a=await P.post(b.auth.login,r);if(a?.data?.token){const{role:l}=a.data.user,f=a.data.token;y.success("Login successful");const x=L.formatPermissionsAndSet(l?.permissions),h={...a.data.user,role:l};c(h,f,x),localStorage.setItem("token",a.data.token),u(k.DASHBOARD)}}catch(a){console.log("Login error:",a)}finally{o(!1)}};return s.jsxs("div",{className:"mx-auto bg-transparent w-full",children:[d&&s.jsx(E,{}),s.jsx("img",{src:"/assets/images/logo.png",className:"w-[250px] mx-auto bg-transparent"}),s.jsxs("form",{onSubmit:p(g),className:"grid gap-5 mt-5",children:[s.jsx(i,{name:"username",control:t,render:({field:e})=>s.jsx(m,{required:!0,autoFocus:!0,...e,label:"Email Address",error:n?.username?.message,placeholder:"Enter email address"})}),s.jsx(i,{name:"password",control:t,render:({field:e})=>s.jsx(m,{required:!0,...e,type:"password",label:"Password",placeholder:"Enter password",error:n?.password?.message})}),s.jsx(S,{className:"w-full my-5",children:"Login"})]})]})};export{I as default};
