import{u as C,b as N,a as k,r as u,j as t,B as h,h as m,e as l,y as p}from"./index-DZUejYSu.js";import{u as w,C as i}from"./index.esm-8JYv16KU.js";import{o as U,i as F,a as A}from"./yup-CyIqaq5C.js";import{T as d}from"./TextInput-CfYT9kxn.js";import{T as M}from"./TextArea-DQ1G-Ggy.js";import{L as T}from"./Loading-BZ-_58ep.js";import{F as q}from"./FormHeader-DC4am5AO.js";import{S as E}from"./SearchableSelect-C6IXXd44.js";import"./BackButton-DGqmmXaI.js";const B={item_name:"",description:"",unit_id:"",is_active:!0,current_stock:"",note:""},K=()=>{const _=C(),[x]=N(),r=x.get("editId")?Number(x.get("editId")):void 0,{selectedBranchId:v}=k(),[c,n]=u.useState(!1),[f,j]=u.useState([]),{control:a,handleSubmit:b,reset:g,formState:{errors:o}}=w({defaultValues:B,resolver:U(r?A:F)}),y=async()=>{n(!0);try{const e=await m.get(l.unit_master.all);j(e.data.units)}finally{n(!1)}},I=async()=>{if(r){n(!0);try{const s=(await m.get(l.item_master.details(r))).data.item;g({item_name:s.item_name,item_code:s.item_code,description:s.description,is_active:s.is_active,current_stock:s.current_stock,unit_id:s.unit_id,note:s.note||"",branch_id:v})}finally{n(!1)}}};u.useEffect(()=>{y(),r&&I()},[r]);const S=async e=>{n(!0);try{const s=r?{item_name:e.item_name,description:e.description,is_active:e.is_active,unit_id:e.unit_id,current_stock:e.current_stock}:{item_name:e.item_name,description:e.description,is_active:e.is_active,unit_id:e.unit_id,current_stock:e.current_stock};r?(await m.put(l.item_master.update(r),s),p.success("Item Updated Successfully")):(await m.post(l.item_master.create,s),p.success("Item Created Successfully")),_("/master/item-master/list")}catch(s){console.error(s),p.error(s.response?.data?.message||"Failed to save item")}finally{n(!1)}};return c&&r?t.jsx("div",{className:"flex justify-center py-20",children:t.jsx(T,{})}):t.jsxs("div",{className:"w-full h-full overflow-auto space-y-8 p-4 pb-20",children:[t.jsx("div",{className:"space-y-1 ml-2",children:t.jsx(q,{title:r?"Edit Item Master":"Create Item Master",subtitle:r?"Update the Item Master details":"Fill out the form to submit a new Item Master."})}),t.jsxs("div",{className:"grid grid-cols-3 gap-5 ml-2 mr-5 mt-5",children:[t.jsx(i,{name:"item_name",control:a,render:({field:e})=>t.jsx(d,{required:!0,...e,label:"Item Name",error:o?.item_name?.message})}),r&&t.jsx(i,{name:"item_code",control:a,render:({field:e})=>t.jsx(d,{required:!0,...e,label:"Item Code",error:o?.item_code?.message,disabled:!!r})}),t.jsx(i,{name:"description",control:a,render:({field:e})=>t.jsx(d,{required:!0,...e,label:"Description",error:o?.description?.message})}),t.jsx(i,{name:"unit_id",control:a,render:({field:e})=>t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:"Unit"}),t.jsx(E,{options:f.filter(s=>s.is_active).map(s=>({value:Number(s.id),label:s.unit_name})),value:e.value?Number(e.value):void 0,onChange:s=>e.onChange(s),placeholder:"Select Unit",error:o.unit_id?.message})]})}),t.jsx(i,{name:"current_stock",control:a,render:({field:e})=>t.jsx(d,{required:!0,...e,type:"number",label:"Current Stock",error:o?.current_stock?.message})}),t.jsx(i,{name:"is_active",control:a,render:({field:e})=>t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:"Is Active"}),t.jsxs("select",{...e,onChange:s=>e.onChange(s.target.value==="true"),className:"w-full border rounded p-2",value:e.value?"true":"false",children:[t.jsx("option",{value:"true",children:"True"}),t.jsx("option",{value:"false",children:"False"})]})]})})]}),t.jsx("div",{className:"ml-2 mr-5 mt-5",children:t.jsx(i,{name:"note",control:a,render:({field:e})=>t.jsx(M,{...e,label:"Note",placeholder:"Add any additional notes or comments...",rows:3,error:o?.note?.message})})}),t.jsxs("div",{className:"flex justify-end gap-3 mt-5 mr-5",children:[t.jsx(h,{onClick:()=>_("/master/item-master/list"),variant:"outline",disabled:c,children:"Cancel"}),t.jsx(h,{onClick:b(S),loading:c,disabled:c,children:r?"Update Item":"Create Item"})]})]})};export{K as default};
