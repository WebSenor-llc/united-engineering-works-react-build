import{u as R,r as n,a as D,j as t,A as x,h as j,e as T,y as p}from"./index-CIf2W7T7.js";import{L as G}from"./ListWrapper-Be8LIQ17.js";import{T as S,a as v,b as r}from"./TableWrapper-g99PpvT3.js";import{T as w}from"./TableRow-DHv_dkoN.js";import{u as V}from"./usePagination-DbkRSAPd.js";import{T as C}from"./TableActions-CrsIjR7v.js";import{T as $}from"./TableDelete-fFPjkBDH.js";import{T as B}from"./TableView-DfxhNljb.js";import{L as O}from"./Loading-BnbURCyj.js";import{C as k}from"./CommonFilter-DjQ01qdR.js";import"./index.esm-CUp1BdJ-.js";import"./TextInput-D0k-eW_z.js";const Z=()=>{const{page:l,rowsPerPage:i,setTotal:b,renderPagination:y}=V(),N=R(),[m,u]=n.useState([]),[g,f]=n.useState(!1),{selectedBranchId:_}=D(),[d,A]=n.useState({}),E=[{name:"date_from",label:"Date From",type:"date"},{name:"date_to",label:"Date To",type:"date"}],P=a=>{if(!a)return"";const[e]=a.split("T"),[s,o,c]=e.split("-");return`${c}-${o}-${s}`};n.useEffect(()=>{(async e=>{f(!0);try{const s={page:l+1,rowsPerPage:i,branch_id:_};e&&(e.date_from&&e.date_to?e.date_from===e.date_to?s.date=e.date_from:(s.date_from=e.date_from,s.date_to=e.date_to):(e.date_from&&(s.date_from=e.date_from),e.date_to&&(s.date_to=e.date_to)));const o=await j.get(T.non_returnable_gate_pass.items,{params:s}),c=o.data?.gate_passes||o.data?.data||o.data||[],h=o.data?.pagination;u(c),h?.total!==void 0&&b(h.total)}catch(s){console.error("Failed to fetch non-returnable gate passes",s),p.error("Failed to load gate passes")}finally{f(!1)}})(d)},[l,i,_,d]);const F=async a=>{A(a)},L=async a=>{try{await j.delete(T.non_returnable_gate_pass.delete(a)),u(e=>e.filter(s=>s.id!==a)),p.success("Gate pass deleted successfully")}catch(e){console.error("Failed to delete gate pass",e),p.error("Failed to delete gate pass")}};return t.jsxs("div",{className:"space-y-6",children:[t.jsx(k,{fields:E,onFilter:F,defaultValues:d}),t.jsxs(G,{title:"Non Returnable Gate Pass List",createOnClick:()=>N(x.NON_RETURNABLE_GATEPAS.CREATE),children:[g?t.jsx("div",{className:"flex justify-center py-10",children:t.jsx(O,{})}):t.jsxs(S,{children:[t.jsx(v,{cols:[{title:"Date"},{title:"Party Name"},{title:"Purpose"},{title:"Vehicle Number"},{title:"Actions"}]}),t.jsx("tbody",{children:m.length===0?t.jsx("tr",{children:t.jsx("td",{colSpan:6,className:"text-center py-8 text-gray-500",children:"No gate passes found"})}):m.map((a,e)=>t.jsxs(w,{children:[t.jsx(r,{className:"px-5",children:l*i+e+1}),t.jsx(r,{children:P(a.created_at||a.date)}),t.jsx(r,{children:a.party_name||"-"}),t.jsx(r,{children:a.purpose||"-"}),t.jsx(r,{children:a.vehicle_number||"-"}),t.jsx(r,{children:t.jsxs(C,{children:[t.jsx(B,{url:`${x.NON_RETURNABLE_GATEPAS.DETAILS.replace(":id","")}${a.id}`,tooltip:"View Non-Returnable Gate Pass Details"}),t.jsx($,{onClick:()=>L(a.id)})]})})]},a.id))})]}),y()]})]})};export{Z as default};
