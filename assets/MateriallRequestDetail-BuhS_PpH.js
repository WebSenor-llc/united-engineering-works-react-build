import{l as h,r as l,j as e,D as j,h as u,e as p}from"./index-C1K7pf_x.js";import{B as g}from"./BackButton-B2Rfagm-.js";import{L as _}from"./Loading-CCwfYO4Q.js";import{N as b}from"./NoDataFound-QJfIXQAW.js";import{T as f,a as N,b as i}from"./TableWrapper-DsVaOnkl.js";import{T as y}from"./TableRow-DCBy3unw.js";const t=(n,c)=>n&&(typeof n=="string"||typeof n=="number")?n:"--",k=()=>{const{id:n}=h(),[c,d]=l.useState(!1),[s,o]=l.useState(null),x=async()=>{d(!0);try{const a=await u.get(p.material_requisition.details(Number(n))),r=a.data?.data?.material_requisition||a.data?.material_requisition||a.data,m={...r,department:typeof r?.department=="object"&&r.department?r.department.branch_name:r.department,machine_use:typeof r?.machine_use=="object"&&r.machine_use?r.machine_use.name:r.machine_use,site_use:typeof r?.site_use=="object"&&r.site_use?r.site_use.branch_name:r.site_use};o(m)}catch(a){console.log("Failed to load MR details",a)}finally{d(!1)}};return l.useEffect(()=>{n&&x()},[n]),c?e.jsx(_,{}):s?e.jsxs("div",{className:"max-w-6xl mx-auto min-h-screen p-4 bg-gray-50 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(g,{}),e.jsx("h2",{className:"text-xl font-semibold",children:"Material Request Details"})]}),e.jsxs("div",{className:"bg-white border p-6 rounded-xl space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Basic Details"}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4 text-gray-700",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"MR Number:"})," ",t(s.mr_number)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Department:"})," ",t(s.department)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"}),e.jsx("span",{className:"inline-flex ml-2 px-2 py-1 text-xs font-medium bg-gray-100 text-gray-800 rounded-full",children:t(s.status)})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Priority:"})," ",t(s.priority)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Required Date:"})," ",s.required_by_date?j.dateWithTime(s.required_by_date):"--"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Inspection:"})," ",s.inspection?"Yes":"No"]}),e.jsxs("p",{className:"col-span-full",children:[e.jsx("strong",{children:"Purpose / Remarks:"})," ",t(s.remarks)]})]}),(s.status?.includes("Cancelled")||s.status?.includes("Rejected"))&&e.jsxs("div",{className:"mt-2 p-2 bg-red-50 border border-red-200 rounded text-red-800",children:[e.jsxs("strong",{children:[s.status?.includes("Cancelled")?"Cancellation":"Rejection"," ","Reason:"]})," ",t(s.cancellation_reason||s.rejection_reason)]})]}),e.jsxs("div",{className:"bg-white border p-6 rounded-xl space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Usage Details"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 text-gray-700",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Project Use:"})," ",t(s.project_use)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Project Note:"})," ",t(s.project_note)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Machine Use:"})," ",t(s.machine_use)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Machine Note:"})," ",t(s.machine_note)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Site Use:"})," ",t(s.site_use)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Site Note:"})," ",t(s.site_note)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"General Use:"})," ",t(s.general_use)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"General Note:"})," ",t(s.general_note)]})]})]}),e.jsxs("div",{className:"bg-white border p-6 rounded-xl",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-4",children:"Items Requested"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(f,{children:[e.jsx(N,{cols:[{title:"Item Name"},{title:"Item Code"},{title:"Unit"},{title:"Requested Qty"},{title:"Stock In Store"},{title:"Remarks"}]}),e.jsx("tbody",{children:s.items?.length>0?s.items.map((a,r)=>e.jsxs(y,{children:[e.jsx(i,{className:"text-center",children:r+1}),e.jsx(i,{children:t(a.item?.item_name)}),e.jsx(i,{children:t(a.item?.item_code)}),e.jsx(i,{children:t(a.item?.unit?.unit_name)}),e.jsx(i,{className:"text-center",children:a.quantity_required??0}),e.jsx(i,{className:"text-center",children:a.item?.current_stock??"--"}),e.jsx(i,{children:t(a.remarks)})]},a.item_id||r)):e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center py-4",children:"No Items Found"})})})]})})]})]}):e.jsx(b,{})};export{k as default};
